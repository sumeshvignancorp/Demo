<html>
<head>
<title>worksheet.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #5f826b; font-style: italic;}
.s3 { color: #cf8e6d;}
.s4 { color: #bcbec4;}
.s5 { color: #6aab73;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
worksheet.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright (c) 2010-2023 openpyxl</span>

<span class="s2">&quot;&quot;&quot;Worksheet is the 2nd-level container in Excel.&quot;&quot;&quot;</span>


<span class="s0"># Python stdlib imports</span>
<span class="s3">from </span><span class="s1">itertools </span><span class="s3">import </span><span class="s1">chain</span>
<span class="s3">from </span><span class="s1">operator </span><span class="s3">import </span><span class="s1">itemgetter</span>
<span class="s3">from </span><span class="s1">inspect </span><span class="s3">import </span><span class="s1">isgenerator</span>
<span class="s3">from </span><span class="s1">warnings </span><span class="s3">import </span><span class="s1">warn</span>

<span class="s0"># compatibility imports</span>
<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">compat </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">deprecated</span><span class="s4">,</span>
<span class="s4">)</span>

<span class="s0"># package imports</span>
<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">utils </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">column_index_from_string</span><span class="s4">,</span>
    <span class="s1">get_column_letter</span><span class="s4">,</span>
    <span class="s1">range_boundaries</span><span class="s4">,</span>
    <span class="s1">coordinate_to_tuple</span><span class="s4">,</span>
    <span class="s1">absolute_coordinate</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">cell </span><span class="s3">import </span><span class="s1">Cell</span><span class="s4">, </span><span class="s1">MergedCell</span>
<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">formatting</span><span class="s4">.</span><span class="s1">formatting </span><span class="s3">import </span><span class="s1">ConditionalFormattingList</span>
<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">packaging</span><span class="s4">.</span><span class="s1">relationship </span><span class="s3">import </span><span class="s1">RelationshipList</span>
<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">workbook</span><span class="s4">.</span><span class="s1">child </span><span class="s3">import </span><span class="s1">_WorkbookChild</span>
<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">workbook</span><span class="s4">.</span><span class="s1">defined_name </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">DefinedNameDict</span><span class="s4">,</span>
<span class="s4">)</span>

<span class="s3">from </span><span class="s1">openpyxl</span><span class="s4">.</span><span class="s1">formula</span><span class="s4">.</span><span class="s1">translate </span><span class="s3">import </span><span class="s1">Translator</span>

<span class="s3">from </span><span class="s4">.</span><span class="s1">datavalidation </span><span class="s3">import </span><span class="s1">DataValidationList</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">page </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">PrintPageSetup</span><span class="s4">,</span>
    <span class="s1">PageMargins</span><span class="s4">,</span>
    <span class="s1">PrintOptions</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">dimensions </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">ColumnDimension</span><span class="s4">,</span>
    <span class="s1">RowDimension</span><span class="s4">,</span>
    <span class="s1">DimensionHolder</span><span class="s4">,</span>
    <span class="s1">SheetFormatProperties</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">protection </span><span class="s3">import </span><span class="s1">SheetProtection</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">filters </span><span class="s3">import </span><span class="s1">AutoFilter</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">views </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">Pane</span><span class="s4">,</span>
    <span class="s1">Selection</span><span class="s4">,</span>
    <span class="s1">SheetViewList</span><span class="s4">,</span>
<span class="s4">)</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">cell_range </span><span class="s3">import </span><span class="s1">MultiCellRange</span><span class="s4">, </span><span class="s1">CellRange</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">merge </span><span class="s3">import </span><span class="s1">MergedCellRange</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">properties </span><span class="s3">import </span><span class="s1">WorksheetProperties</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">pagebreak </span><span class="s3">import </span><span class="s1">RowBreak</span><span class="s4">, </span><span class="s1">ColBreak</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">scenario </span><span class="s3">import </span><span class="s1">ScenarioList</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">table </span><span class="s3">import </span><span class="s1">TableList</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">formula </span><span class="s3">import </span><span class="s1">ArrayFormula</span>
<span class="s3">from </span><span class="s4">.</span><span class="s1">print_settings </span><span class="s3">import </span><span class="s4">(</span>
    <span class="s1">PrintTitles</span><span class="s4">,</span>
    <span class="s1">ColRange</span><span class="s4">,</span>
    <span class="s1">RowRange</span><span class="s4">,</span>
    <span class="s1">PrintArea</span><span class="s4">,</span>
<span class="s4">)</span>


<span class="s3">class </span><span class="s1">Worksheet</span><span class="s4">(</span><span class="s1">_WorkbookChild</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot;Represents a worksheet. 
 
    Do not create worksheets yourself, 
    use :func:`openpyxl.workbook.Workbook.create_sheet` instead 
 
    &quot;&quot;&quot;</span>

    <span class="s1">_rel_type </span><span class="s4">= </span><span class="s5">&quot;worksheet&quot;</span>
    <span class="s1">_path </span><span class="s4">= </span><span class="s5">&quot;/xl/worksheets/sheet{0}.xml&quot;</span>
    <span class="s1">mime_type </span><span class="s4">= </span><span class="s5">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml&quot;</span>

    <span class="s1">BREAK_NONE </span><span class="s4">= </span><span class="s6">0</span>
    <span class="s1">BREAK_ROW </span><span class="s4">= </span><span class="s6">1</span>
    <span class="s1">BREAK_COLUMN </span><span class="s4">= </span><span class="s6">2</span>

    <span class="s1">SHEETSTATE_VISIBLE </span><span class="s4">= </span><span class="s5">'visible'</span>
    <span class="s1">SHEETSTATE_HIDDEN </span><span class="s4">= </span><span class="s5">'hidden'</span>
    <span class="s1">SHEETSTATE_VERYHIDDEN </span><span class="s4">= </span><span class="s5">'veryHidden'</span>

    <span class="s0"># Paper size</span>
    <span class="s1">PAPERSIZE_LETTER </span><span class="s4">= </span><span class="s5">'1'</span>
    <span class="s1">PAPERSIZE_LETTER_SMALL </span><span class="s4">= </span><span class="s5">'2'</span>
    <span class="s1">PAPERSIZE_TABLOID </span><span class="s4">= </span><span class="s5">'3'</span>
    <span class="s1">PAPERSIZE_LEDGER </span><span class="s4">= </span><span class="s5">'4'</span>
    <span class="s1">PAPERSIZE_LEGAL </span><span class="s4">= </span><span class="s5">'5'</span>
    <span class="s1">PAPERSIZE_STATEMENT </span><span class="s4">= </span><span class="s5">'6'</span>
    <span class="s1">PAPERSIZE_EXECUTIVE </span><span class="s4">= </span><span class="s5">'7'</span>
    <span class="s1">PAPERSIZE_A3 </span><span class="s4">= </span><span class="s5">'8'</span>
    <span class="s1">PAPERSIZE_A4 </span><span class="s4">= </span><span class="s5">'9'</span>
    <span class="s1">PAPERSIZE_A4_SMALL </span><span class="s4">= </span><span class="s5">'10'</span>
    <span class="s1">PAPERSIZE_A5 </span><span class="s4">= </span><span class="s5">'11'</span>

    <span class="s0"># Page orientation</span>
    <span class="s1">ORIENTATION_PORTRAIT </span><span class="s4">= </span><span class="s5">'portrait'</span>
    <span class="s1">ORIENTATION_LANDSCAPE </span><span class="s4">= </span><span class="s5">'landscape'</span>

    <span class="s3">def </span><span class="s1">__init__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">parent</span><span class="s4">, </span><span class="s1">title</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s1">_WorkbookChild</span><span class="s4">.</span><span class="s1">__init__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">parent</span><span class="s4">, </span><span class="s1">title</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_setup</span><span class="s4">()</span>

    <span class="s3">def </span><span class="s1">_setup</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">row_dimensions </span><span class="s4">= </span><span class="s1">DimensionHolder</span><span class="s4">(</span><span class="s1">worksheet</span><span class="s4">=</span><span class="s1">self</span><span class="s4">,</span>
                                              <span class="s1">default_factory</span><span class="s4">=</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_add_row</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">column_dimensions </span><span class="s4">= </span><span class="s1">DimensionHolder</span><span class="s4">(</span><span class="s1">worksheet</span><span class="s4">=</span><span class="s1">self</span><span class="s4">,</span>
                                                 <span class="s1">default_factory</span><span class="s4">=</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_add_column</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">row_breaks </span><span class="s4">= </span><span class="s1">RowBreak</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">col_breaks </span><span class="s4">= </span><span class="s1">ColBreak</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_cells </span><span class="s4">= {}</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_charts </span><span class="s4">= []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_images </span><span class="s4">= []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_rels </span><span class="s4">= </span><span class="s1">RelationshipList</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_drawing </span><span class="s4">= </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_comments </span><span class="s4">= []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">merged_cells </span><span class="s4">= </span><span class="s1">MultiCellRange</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_tables </span><span class="s4">= </span><span class="s1">TableList</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_pivots </span><span class="s4">= []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">data_validations </span><span class="s4">= </span><span class="s1">DataValidationList</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_hyperlinks </span><span class="s4">= []</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_state </span><span class="s4">= </span><span class="s5">'visible'</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">page_setup </span><span class="s4">= </span><span class="s1">PrintPageSetup</span><span class="s4">(</span><span class="s1">worksheet</span><span class="s4">=</span><span class="s1">self</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">print_options </span><span class="s4">= </span><span class="s1">PrintOptions</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_rows </span><span class="s4">= </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_cols </span><span class="s4">= </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_area </span><span class="s4">= </span><span class="s1">PrintArea</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">page_margins </span><span class="s4">= </span><span class="s1">PageMargins</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">views </span><span class="s4">= </span><span class="s1">SheetViewList</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">protection </span><span class="s4">= </span><span class="s1">SheetProtection</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">defined_names </span><span class="s4">= </span><span class="s1">DefinedNameDict</span><span class="s4">()</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">= </span><span class="s6">0</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">auto_filter </span><span class="s4">= </span><span class="s1">AutoFilter</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">conditional_formatting </span><span class="s4">= </span><span class="s1">ConditionalFormattingList</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">legacy_drawing </span><span class="s4">= </span><span class="s3">None</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_properties </span><span class="s4">= </span><span class="s1">WorksheetProperties</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_format </span><span class="s4">= </span><span class="s1">SheetFormatProperties</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">scenarios </span><span class="s4">= </span><span class="s1">ScenarioList</span><span class="s4">()</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">sheet_view</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">views</span><span class="s4">.</span><span class="s1">sheetView</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">selected_cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_view</span><span class="s4">.</span><span class="s1">selection</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">sqref</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">active_cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_view</span><span class="s4">.</span><span class="s1">selection</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">activeCell</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">array_formulae</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Returns a dictionary of cells with array formulae and the cells in array&quot;&quot;&quot;</span>
        <span class="s1">result </span><span class="s4">= {}</span>
        <span class="s3">for </span><span class="s1">c </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">.</span><span class="s1">values</span><span class="s4">():</span>
            <span class="s3">if </span><span class="s1">c</span><span class="s4">.</span><span class="s1">data_type </span><span class="s4">== </span><span class="s5">&quot;f&quot;</span><span class="s4">:</span>
                <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">c</span><span class="s4">.</span><span class="s1">value</span><span class="s4">, </span><span class="s1">ArrayFormula</span><span class="s4">):</span>
                    <span class="s1">result</span><span class="s4">[</span><span class="s1">c</span><span class="s4">.</span><span class="s1">coordinate</span><span class="s4">] = </span><span class="s1">c</span><span class="s4">.</span><span class="s1">value</span><span class="s4">.</span><span class="s1">ref</span>
        <span class="s3">return </span><span class="s1">result</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">show_gridlines</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_view</span><span class="s4">.</span><span class="s1">showGridLines</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">freeze_panes</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_view</span><span class="s4">.</span><span class="s1">pane </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_view</span><span class="s4">.</span><span class="s1">pane</span><span class="s4">.</span><span class="s1">topLeftCell</span>


    <span class="s4">@</span><span class="s1">freeze_panes</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">freeze_panes</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">topLeftCell</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">topLeftCell</span><span class="s4">, </span><span class="s1">Cell</span><span class="s4">):</span>
            <span class="s1">topLeftCell </span><span class="s4">= </span><span class="s1">topLeftCell</span><span class="s4">.</span><span class="s1">coordinate</span>
        <span class="s3">if </span><span class="s1">topLeftCell </span><span class="s4">== </span><span class="s5">'A1'</span><span class="s4">:</span>
            <span class="s1">topLeftCell </span><span class="s4">= </span><span class="s3">None</span>

        <span class="s3">if not </span><span class="s1">topLeftCell</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_view</span><span class="s4">.</span><span class="s1">pane </span><span class="s4">= </span><span class="s3">None</span>
            <span class="s3">return</span>

        <span class="s1">row</span><span class="s4">, </span><span class="s1">column </span><span class="s4">= </span><span class="s1">coordinate_to_tuple</span><span class="s4">(</span><span class="s1">topLeftCell</span><span class="s4">)</span>

        <span class="s1">view </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">sheet_view</span>
        <span class="s1">view</span><span class="s4">.</span><span class="s1">pane </span><span class="s4">= </span><span class="s1">Pane</span><span class="s4">(</span><span class="s1">topLeftCell</span><span class="s4">=</span><span class="s1">topLeftCell</span><span class="s4">,</span>
                        <span class="s1">activePane</span><span class="s4">=</span><span class="s5">&quot;topRight&quot;</span><span class="s4">,</span>
                        <span class="s1">state</span><span class="s4">=</span><span class="s5">&quot;frozen&quot;</span><span class="s4">)</span>
        <span class="s1">view</span><span class="s4">.</span><span class="s1">selection</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">pane </span><span class="s4">= </span><span class="s5">&quot;topRight&quot;</span>

        <span class="s3">if </span><span class="s1">column </span><span class="s4">&gt; </span><span class="s6">1</span><span class="s4">:</span>
            <span class="s1">view</span><span class="s4">.</span><span class="s1">pane</span><span class="s4">.</span><span class="s1">xSplit </span><span class="s4">= </span><span class="s1">column </span><span class="s4">- </span><span class="s6">1</span>
        <span class="s3">if </span><span class="s1">row </span><span class="s4">&gt; </span><span class="s6">1</span><span class="s4">:</span>
            <span class="s1">view</span><span class="s4">.</span><span class="s1">pane</span><span class="s4">.</span><span class="s1">ySplit </span><span class="s4">= </span><span class="s1">row </span><span class="s4">- </span><span class="s6">1</span>
            <span class="s1">view</span><span class="s4">.</span><span class="s1">pane</span><span class="s4">.</span><span class="s1">activePane </span><span class="s4">= </span><span class="s5">'bottomLeft'</span>
            <span class="s1">view</span><span class="s4">.</span><span class="s1">selection</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">pane </span><span class="s4">= </span><span class="s5">&quot;bottomLeft&quot;</span>
            <span class="s3">if </span><span class="s1">column </span><span class="s4">&gt; </span><span class="s6">1</span><span class="s4">:</span>
                <span class="s1">view</span><span class="s4">.</span><span class="s1">selection</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">pane </span><span class="s4">= </span><span class="s5">&quot;bottomRight&quot;</span>
                <span class="s1">view</span><span class="s4">.</span><span class="s1">pane</span><span class="s4">.</span><span class="s1">activePane </span><span class="s4">= </span><span class="s5">'bottomRight'</span>

        <span class="s3">if </span><span class="s1">row </span><span class="s4">&gt; </span><span class="s6">1 </span><span class="s3">and </span><span class="s1">column </span><span class="s4">&gt; </span><span class="s6">1</span><span class="s4">:</span>
            <span class="s1">sel </span><span class="s4">= </span><span class="s1">list</span><span class="s4">(</span><span class="s1">view</span><span class="s4">.</span><span class="s1">selection</span><span class="s4">)</span>
            <span class="s1">sel</span><span class="s4">.</span><span class="s1">insert</span><span class="s4">(</span><span class="s6">0</span><span class="s4">, </span><span class="s1">Selection</span><span class="s4">(</span><span class="s1">pane</span><span class="s4">=</span><span class="s5">&quot;topRight&quot;</span><span class="s4">, </span><span class="s1">activeCell</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">sqref</span><span class="s4">=</span><span class="s3">None</span><span class="s4">))</span>
            <span class="s1">sel</span><span class="s4">.</span><span class="s1">insert</span><span class="s4">(</span><span class="s6">1</span><span class="s4">, </span><span class="s1">Selection</span><span class="s4">(</span><span class="s1">pane</span><span class="s4">=</span><span class="s5">&quot;bottomLeft&quot;</span><span class="s4">, </span><span class="s1">activeCell</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">sqref</span><span class="s4">=</span><span class="s3">None</span><span class="s4">))</span>
            <span class="s1">view</span><span class="s4">.</span><span class="s1">selection </span><span class="s4">= </span><span class="s1">sel</span>


    <span class="s3">def </span><span class="s1">cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">, </span><span class="s1">value</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Returns a cell object based on the given coordinates. 
 
        Usage: cell(row=15, column=1, value=5) 
 
        Calling `cell` creates cells in memory when they 
        are first accessed. 
 
        :param row: row index of the cell (e.g. 4) 
        :type row: int 
 
        :param column: column index of the cell (e.g. 3) 
        :type column: int 
 
        :param value: value of the cell (e.g. 5) 
        :type value: numeric or time or string or bool or none 
 
        :rtype: openpyxl.cell.cell.Cell 
        &quot;&quot;&quot;</span>

        <span class="s3">if </span><span class="s1">row </span><span class="s4">&lt; </span><span class="s6">1 </span><span class="s3">or </span><span class="s1">column </span><span class="s4">&lt; </span><span class="s6">1</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Row or column values must be at least 1&quot;</span><span class="s4">)</span>

        <span class="s1">cell </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_get_cell</span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">value </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">cell</span><span class="s4">.</span><span class="s1">value </span><span class="s4">= </span><span class="s1">value</span>

        <span class="s3">return </span><span class="s1">cell</span>


    <span class="s3">def </span><span class="s1">_get_cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Internal method for getting a cell from a worksheet. 
        Will create a new cell if one doesn't already exist. 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s6">0 </span><span class="s4">&lt; </span><span class="s1">row </span><span class="s4">&lt; </span><span class="s6">1048577</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">f&quot;Row numbers must be between 1 and 1048576. Row number supplied was </span><span class="s3">{</span><span class="s1">row</span><span class="s3">}</span><span class="s5">&quot;</span><span class="s4">)</span>
        <span class="s1">coordinate </span><span class="s4">= (</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">)</span>
        <span class="s3">if not </span><span class="s1">coordinate </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s1">cell </span><span class="s4">= </span><span class="s1">Cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">row</span><span class="s4">=</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">=</span><span class="s1">column</span><span class="s4">)</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_add_cell</span><span class="s4">(</span><span class="s1">cell</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[</span><span class="s1">coordinate</span><span class="s4">]</span>


    <span class="s3">def </span><span class="s1">_add_cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">cell</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Internal method for adding cell objects. 
        &quot;&quot;&quot;</span>
        <span class="s1">column </span><span class="s4">= </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">col_idx</span>
        <span class="s1">row </span><span class="s4">= </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">row</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">= </span><span class="s1">max</span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">)] = </span><span class="s1">cell</span>


    <span class="s3">def </span><span class="s1">__getitem__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">key</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Convenience access by Excel style coordinates 
 
        The key can be a single cell coordinate 'A1', a range of cells 'A1:D25', 
        individual rows or columns 'A', 4 or ranges of rows or columns 'A:D', 
        4:10. 
 
        Single cells will always be created if they do not exist. 
 
        Returns either a single cell or a tuple of rows or columns. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">key</span><span class="s4">, </span><span class="s1">slice</span><span class="s4">):</span>
            <span class="s3">if not </span><span class="s1">all</span><span class="s4">([</span><span class="s1">key</span><span class="s4">.</span><span class="s1">start</span><span class="s4">, </span><span class="s1">key</span><span class="s4">.</span><span class="s1">stop</span><span class="s4">]):</span>
                <span class="s3">raise </span><span class="s1">IndexError</span><span class="s4">(</span><span class="s5">&quot;{0} is not a valid coordinate or range&quot;</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">key</span><span class="s4">))</span>
            <span class="s1">key </span><span class="s4">= </span><span class="s5">&quot;{0}:{1}&quot;</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">key</span><span class="s4">.</span><span class="s1">start</span><span class="s4">, </span><span class="s1">key</span><span class="s4">.</span><span class="s1">stop</span><span class="s4">)</span>

        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">key</span><span class="s4">, </span><span class="s1">int</span><span class="s4">):</span>
            <span class="s1">key </span><span class="s4">= </span><span class="s1">str</span><span class="s4">(</span><span class="s1">key</span>
                      <span class="s4">)</span>
        <span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row </span><span class="s4">= </span><span class="s1">range_boundaries</span><span class="s4">(</span><span class="s1">key</span><span class="s4">)</span>

        <span class="s3">if not </span><span class="s1">any</span><span class="s4">([</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">]):</span>
            <span class="s3">raise </span><span class="s1">IndexError</span><span class="s4">(</span><span class="s5">&quot;{0} is not a valid coordinate or range&quot;</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">key</span><span class="s4">))</span>

        <span class="s3">if </span><span class="s1">min_row </span><span class="s3">is None</span><span class="s4">:</span>
            <span class="s1">cols </span><span class="s4">= </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_cols</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">))</span>
            <span class="s3">if </span><span class="s1">min_col </span><span class="s4">== </span><span class="s1">max_col</span><span class="s4">:</span>
                <span class="s1">cols </span><span class="s4">= </span><span class="s1">cols</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]</span>
            <span class="s3">return </span><span class="s1">cols</span>
        <span class="s3">if </span><span class="s1">min_col </span><span class="s3">is None</span><span class="s4">:</span>
            <span class="s1">rows </span><span class="s4">= </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_rows</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">=</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">=</span><span class="s1">min_row</span><span class="s4">,</span>
                                        <span class="s1">max_col</span><span class="s4">=</span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_column</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">=</span><span class="s1">max_row</span><span class="s4">))</span>
            <span class="s3">if </span><span class="s1">min_row </span><span class="s4">== </span><span class="s1">max_row</span><span class="s4">:</span>
                <span class="s1">rows </span><span class="s4">= </span><span class="s1">rows</span><span class="s4">[</span><span class="s6">0</span><span class="s4">]</span>
            <span class="s3">return </span><span class="s1">rows</span>
        <span class="s3">if </span><span class="s5">&quot;:&quot; </span><span class="s3">not in </span><span class="s1">key</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_get_cell</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_rows</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">=</span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">=</span><span class="s1">min_col</span><span class="s4">,</span>
                                    <span class="s1">max_row</span><span class="s4">=</span><span class="s1">max_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">=</span><span class="s1">max_col</span><span class="s4">))</span>


    <span class="s3">def </span><span class="s1">__setitem__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">key</span><span class="s4">, </span><span class="s1">value</span><span class="s4">):</span>
        <span class="s1">self</span><span class="s4">[</span><span class="s1">key</span><span class="s4">].</span><span class="s1">value </span><span class="s4">= </span><span class="s1">value</span>


    <span class="s3">def </span><span class="s1">__iter__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_rows</span><span class="s4">()</span>


    <span class="s3">def </span><span class="s1">__delitem__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">key</span><span class="s4">):</span>
        <span class="s1">row</span><span class="s4">, </span><span class="s1">column </span><span class="s4">= </span><span class="s1">coordinate_to_tuple</span><span class="s4">(</span><span class="s1">key</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">) </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s3">del </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">)]</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">min_row</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;The minimum row index containing data (1-based) 
 
        :type: int 
        &quot;&quot;&quot;</span>
        <span class="s1">min_row </span><span class="s4">= </span><span class="s6">1</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s1">rows </span><span class="s4">= </span><span class="s1">set</span><span class="s4">(</span><span class="s1">c</span><span class="s4">[</span><span class="s6">0</span><span class="s4">] </span><span class="s3">for </span><span class="s1">c </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">)</span>
            <span class="s1">min_row </span><span class="s4">= </span><span class="s1">min</span><span class="s4">(</span><span class="s1">rows</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">min_row</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">max_row</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;The maximum row index containing data (1-based) 
 
        :type: int 
        &quot;&quot;&quot;</span>
        <span class="s1">max_row </span><span class="s4">= </span><span class="s6">1</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s1">rows </span><span class="s4">= </span><span class="s1">set</span><span class="s4">(</span><span class="s1">c</span><span class="s4">[</span><span class="s6">0</span><span class="s4">] </span><span class="s3">for </span><span class="s1">c </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">)</span>
            <span class="s1">max_row </span><span class="s4">= </span><span class="s1">max</span><span class="s4">(</span><span class="s1">rows</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">max_row</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">min_column</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;The minimum column index containing data (1-based) 
 
        :type: int 
        &quot;&quot;&quot;</span>
        <span class="s1">min_col </span><span class="s4">= </span><span class="s6">1</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s1">cols </span><span class="s4">= </span><span class="s1">set</span><span class="s4">(</span><span class="s1">c</span><span class="s4">[</span><span class="s6">1</span><span class="s4">] </span><span class="s3">for </span><span class="s1">c </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">)</span>
            <span class="s1">min_col </span><span class="s4">= </span><span class="s1">min</span><span class="s4">(</span><span class="s1">cols</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">min_col</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">max_column</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;The maximum column index containing data (1-based) 
 
        :type: int 
        &quot;&quot;&quot;</span>
        <span class="s1">max_col </span><span class="s4">= </span><span class="s6">1</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s1">cols </span><span class="s4">= </span><span class="s1">set</span><span class="s4">(</span><span class="s1">c</span><span class="s4">[</span><span class="s6">1</span><span class="s4">] </span><span class="s3">for </span><span class="s1">c </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">)</span>
            <span class="s1">max_col </span><span class="s4">= </span><span class="s1">max</span><span class="s4">(</span><span class="s1">cols</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">max_col</span>


    <span class="s3">def </span><span class="s1">calculate_dimension</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Return the minimum bounding range for all cells containing data (ex. 'A1:M24') 
 
        :rtype: string 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s1">rows </span><span class="s4">= </span><span class="s1">set</span><span class="s4">()</span>
            <span class="s1">cols </span><span class="s4">= </span><span class="s1">set</span><span class="s4">()</span>
            <span class="s3">for </span><span class="s1">row</span><span class="s4">, </span><span class="s1">col </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
                <span class="s1">rows</span><span class="s4">.</span><span class="s1">add</span><span class="s4">(</span><span class="s1">row</span><span class="s4">)</span>
                <span class="s1">cols</span><span class="s4">.</span><span class="s1">add</span><span class="s4">(</span><span class="s1">col</span><span class="s4">)</span>
            <span class="s1">max_row </span><span class="s4">= </span><span class="s1">max</span><span class="s4">(</span><span class="s1">rows</span><span class="s4">)</span>
            <span class="s1">max_col </span><span class="s4">= </span><span class="s1">max</span><span class="s4">(</span><span class="s1">cols</span><span class="s4">)</span>
            <span class="s1">min_col </span><span class="s4">= </span><span class="s1">min</span><span class="s4">(</span><span class="s1">cols</span><span class="s4">)</span>
            <span class="s1">min_row </span><span class="s4">= </span><span class="s1">min</span><span class="s4">(</span><span class="s1">rows</span><span class="s4">)</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s5">&quot;A1:A1&quot;</span>

        <span class="s3">return </span><span class="s5">f&quot;</span><span class="s3">{</span><span class="s1">get_column_letter</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">)</span><span class="s3">}{</span><span class="s1">min_row</span><span class="s3">}</span><span class="s5">:</span><span class="s3">{</span><span class="s1">get_column_letter</span><span class="s4">(</span><span class="s1">max_col</span><span class="s4">)</span><span class="s3">}{</span><span class="s1">max_row</span><span class="s3">}</span><span class="s5">&quot;</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">dimensions</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Returns the result of :func:`calculate_dimension`&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">calculate_dimension</span><span class="s4">()</span>


    <span class="s3">def </span><span class="s1">iter_rows</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">values_only</span><span class="s4">=</span><span class="s3">False</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Produces cells from the worksheet, by row. Specify the iteration range 
        using indices of rows and columns. 
 
        If no indices are specified the range starts at A1. 
 
        If no cells are in the worksheet an empty tuple will be returned. 
 
        :param min_col: smallest column index (1-based index) 
        :type min_col: int 
 
        :param min_row: smallest row index (1-based index) 
        :type min_row: int 
 
        :param max_col: largest column index (1-based index) 
        :type max_col: int 
 
        :param max_row: largest row index (1-based index) 
        :type max_row: int 
 
        :param values_only: whether only cell values should be returned 
        :type values_only: bool 
 
        :rtype: generator 
        &quot;&quot;&quot;</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">== </span><span class="s6">0 </span><span class="s3">and not </span><span class="s1">any</span><span class="s4">([</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row </span><span class="s4">]):</span>
            <span class="s3">return </span><span class="s1">iter</span><span class="s4">(())</span>


        <span class="s1">min_col </span><span class="s4">= </span><span class="s1">min_col </span><span class="s3">or </span><span class="s6">1</span>
        <span class="s1">min_row </span><span class="s4">= </span><span class="s1">min_row </span><span class="s3">or </span><span class="s6">1</span>
        <span class="s1">max_col </span><span class="s4">= </span><span class="s1">max_col </span><span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_column</span>
        <span class="s1">max_row </span><span class="s4">= </span><span class="s1">max_row </span><span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_row</span>

        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells_by_row</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">, </span><span class="s1">values_only</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">_cells_by_row</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">, </span><span class="s1">values_only</span><span class="s4">=</span><span class="s3">False</span><span class="s4">):</span>
        <span class="s3">for </span><span class="s1">row </span><span class="s3">in </span><span class="s1">range</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_row </span><span class="s4">+ </span><span class="s6">1</span><span class="s4">):</span>
            <span class="s1">cells </span><span class="s4">= (</span><span class="s1">self</span><span class="s4">.</span><span class="s1">cell</span><span class="s4">(</span><span class="s1">row</span><span class="s4">=</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">=</span><span class="s1">column</span><span class="s4">) </span><span class="s3">for </span><span class="s1">column </span><span class="s3">in </span><span class="s1">range</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">max_col </span><span class="s4">+ </span><span class="s6">1</span><span class="s4">))</span>
            <span class="s3">if </span><span class="s1">values_only</span><span class="s4">:</span>
                <span class="s3">yield </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">cell</span><span class="s4">.</span><span class="s1">value </span><span class="s3">for </span><span class="s1">cell </span><span class="s3">in </span><span class="s1">cells</span><span class="s4">)</span>
            <span class="s3">else</span><span class="s4">:</span>
                <span class="s3">yield </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">cells</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">rows</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Produces all cells in the worksheet, by row (see :func:`iter_rows`) 
 
        :type: generator 
        &quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_rows</span><span class="s4">()</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">values</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Produces all cell values in the worksheet, by row 
 
        :type: generator 
        &quot;&quot;&quot;</span>
        <span class="s3">for </span><span class="s1">row </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_rows</span><span class="s4">(</span><span class="s1">values_only</span><span class="s4">=</span><span class="s3">True</span><span class="s4">):</span>
            <span class="s3">yield </span><span class="s1">row</span>


    <span class="s3">def </span><span class="s1">iter_cols</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">values_only</span><span class="s4">=</span><span class="s3">False</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Produces cells from the worksheet, by column. Specify the iteration range 
        using indices of rows and columns. 
 
        If no indices are specified the range starts at A1. 
 
        If no cells are in the worksheet an empty tuple will be returned. 
 
        :param min_col: smallest column index (1-based index) 
        :type min_col: int 
 
        :param min_row: smallest row index (1-based index) 
        :type min_row: int 
 
        :param max_col: largest column index (1-based index) 
        :type max_col: int 
 
        :param max_row: largest row index (1-based index) 
        :type max_row: int 
 
        :param values_only: whether only cell values should be returned 
        :type values_only: bool 
 
        :rtype: generator 
        &quot;&quot;&quot;</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">== </span><span class="s6">0 </span><span class="s3">and not </span><span class="s1">any</span><span class="s4">([</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">]):</span>
            <span class="s3">return </span><span class="s1">iter</span><span class="s4">(())</span>

        <span class="s1">min_col </span><span class="s4">= </span><span class="s1">min_col </span><span class="s3">or </span><span class="s6">1</span>
        <span class="s1">min_row </span><span class="s4">= </span><span class="s1">min_row </span><span class="s3">or </span><span class="s6">1</span>
        <span class="s1">max_col </span><span class="s4">= </span><span class="s1">max_col </span><span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_column</span>
        <span class="s1">max_row </span><span class="s4">= </span><span class="s1">max_row </span><span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_row</span>

        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells_by_col</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">, </span><span class="s1">values_only</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">_cells_by_col</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">, </span><span class="s1">values_only</span><span class="s4">=</span><span class="s3">False</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Get cells by column 
        &quot;&quot;&quot;</span>
        <span class="s3">for </span><span class="s1">column </span><span class="s3">in </span><span class="s1">range</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">+</span><span class="s6">1</span><span class="s4">):</span>
            <span class="s1">cells </span><span class="s4">= (</span><span class="s1">self</span><span class="s4">.</span><span class="s1">cell</span><span class="s4">(</span><span class="s1">row</span><span class="s4">=</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">=</span><span class="s1">column</span><span class="s4">)</span>
                        <span class="s3">for </span><span class="s1">row </span><span class="s3">in </span><span class="s1">range</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">+</span><span class="s6">1</span><span class="s4">))</span>
            <span class="s3">if </span><span class="s1">values_only</span><span class="s4">:</span>
                <span class="s3">yield </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">cell</span><span class="s4">.</span><span class="s1">value </span><span class="s3">for </span><span class="s1">cell </span><span class="s3">in </span><span class="s1">cells</span><span class="s4">)</span>
            <span class="s3">else</span><span class="s4">:</span>
                <span class="s3">yield </span><span class="s1">tuple</span><span class="s4">(</span><span class="s1">cells</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">columns</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Produces all cells in the worksheet, by column  (see :func:`iter_cols`)&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_cols</span><span class="s4">()</span>


    <span class="s3">def </span><span class="s1">set_printer_settings</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">paper_size</span><span class="s4">, </span><span class="s1">orientation</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Set printer settings &quot;&quot;&quot;</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">page_setup</span><span class="s4">.</span><span class="s1">paperSize </span><span class="s4">= </span><span class="s1">paper_size</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">page_setup</span><span class="s4">.</span><span class="s1">orientation </span><span class="s4">= </span><span class="s1">orientation</span>


    <span class="s3">def </span><span class="s1">add_data_validation</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">data_validation</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; Add a data-validation object to the sheet.  The data-validation 
            object defines the type of data-validation to be applied and the 
            cell or range of cells it should apply to. 
        &quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">data_validations</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">data_validation</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">add_chart</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">chart</span><span class="s4">, </span><span class="s1">anchor</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Add a chart to the sheet 
        Optionally provide a cell for the top-left anchor 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">anchor </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">chart</span><span class="s4">.</span><span class="s1">anchor </span><span class="s4">= </span><span class="s1">anchor</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_charts</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">chart</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">add_image</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">img</span><span class="s4">, </span><span class="s1">anchor</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Add an image to the sheet. 
        Optionally provide a cell for the top-left anchor 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">anchor </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">img</span><span class="s4">.</span><span class="s1">anchor </span><span class="s4">= </span><span class="s1">anchor</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_images</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">img</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">add_table</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">table</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Check for duplicate name in definedNames and other worksheet tables 
        before adding table. 
        &quot;&quot;&quot;</span>

        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">parent</span><span class="s4">.</span><span class="s1">_duplicate_name</span><span class="s4">(</span><span class="s1">table</span><span class="s4">.</span><span class="s1">name</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Table with name {0} already exists&quot;</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">table</span><span class="s4">.</span><span class="s1">name</span><span class="s4">))</span>
        <span class="s3">if not </span><span class="s1">hasattr</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s5">&quot;_get_cell&quot;</span><span class="s4">):</span>
            <span class="s1">warn</span><span class="s4">(</span><span class="s5">&quot;In write-only mode you must add table columns manually&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_tables</span><span class="s4">.</span><span class="s1">add</span><span class="s4">(</span><span class="s1">table</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">tables</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_tables</span>


    <span class="s3">def </span><span class="s1">add_pivot</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">pivot</span><span class="s4">):</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_pivots</span><span class="s4">.</span><span class="s1">append</span><span class="s4">(</span><span class="s1">pivot</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">merge_cells</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">range_string</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">start_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">start_column</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">end_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">end_column</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; Set merge on a cell range.  Range is a cell range (e.g. A1:E1) &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">range_string </span><span class="s3">is None</span><span class="s4">:</span>
            <span class="s1">cr </span><span class="s4">= </span><span class="s1">CellRange</span><span class="s4">(</span><span class="s1">range_string</span><span class="s4">=</span><span class="s1">range_string</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">=</span><span class="s1">start_column</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">=</span><span class="s1">start_row</span><span class="s4">,</span>
                      <span class="s1">max_col</span><span class="s4">=</span><span class="s1">end_column</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">=</span><span class="s1">end_row</span><span class="s4">)</span>
            <span class="s1">range_string </span><span class="s4">= </span><span class="s1">cr</span><span class="s4">.</span><span class="s1">coord</span>
        <span class="s1">mcr </span><span class="s4">= </span><span class="s1">MergedCellRange</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">range_string</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">merged_cells</span><span class="s4">.</span><span class="s1">add</span><span class="s4">(</span><span class="s1">mcr</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_clean_merge_range</span><span class="s4">(</span><span class="s1">mcr</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">_clean_merge_range</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">mcr</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Remove all but the top left-cell from a range of merged cells 
        and recreate the lost border information. 
        Borders are then applied 
        &quot;&quot;&quot;</span>
        <span class="s1">cells </span><span class="s4">= </span><span class="s1">mcr</span><span class="s4">.</span><span class="s1">cells</span>
        <span class="s1">next</span><span class="s4">(</span><span class="s1">cells</span><span class="s4">) </span><span class="s0"># skip first cell</span>
        <span class="s3">for </span><span class="s1">row</span><span class="s4">, </span><span class="s1">col </span><span class="s3">in </span><span class="s1">cells</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[</span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">] = </span><span class="s1">MergedCell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">)</span>
        <span class="s1">mcr</span><span class="s4">.</span><span class="s1">format</span><span class="s4">()</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s4">@</span><span class="s1">deprecated</span><span class="s4">(</span><span class="s5">&quot;Use ws.merged_cells.ranges&quot;</span><span class="s4">)</span>
    <span class="s3">def </span><span class="s1">merged_cell_ranges</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Return a copy of cell ranges&quot;&quot;&quot;</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">merged_cells</span><span class="s4">.</span><span class="s1">ranges</span><span class="s4">[:]</span>


    <span class="s3">def </span><span class="s1">unmerge_cells</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">range_string</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">start_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">start_column</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">end_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">end_column</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; Remove merge on a cell range.  Range is a cell range (e.g. A1:E1) &quot;&quot;&quot;</span>
        <span class="s1">cr </span><span class="s4">= </span><span class="s1">CellRange</span><span class="s4">(</span><span class="s1">range_string</span><span class="s4">=</span><span class="s1">range_string</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">=</span><span class="s1">start_column</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">=</span><span class="s1">start_row</span><span class="s4">,</span>
                      <span class="s1">max_col</span><span class="s4">=</span><span class="s1">end_column</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">=</span><span class="s1">end_row</span><span class="s4">)</span>

        <span class="s3">if </span><span class="s1">cr</span><span class="s4">.</span><span class="s1">coord </span><span class="s3">not in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">merged_cells</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Cell range {0} is not merged&quot;</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span><span class="s1">cr</span><span class="s4">.</span><span class="s1">coord</span><span class="s4">))</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">merged_cells</span><span class="s4">.</span><span class="s1">remove</span><span class="s4">(</span><span class="s1">cr</span><span class="s4">)</span>

        <span class="s1">cells </span><span class="s4">= </span><span class="s1">cr</span><span class="s4">.</span><span class="s1">cells</span>
        <span class="s1">next</span><span class="s4">(</span><span class="s1">cells</span><span class="s4">) </span><span class="s0"># skip first cell</span>
        <span class="s3">for </span><span class="s1">row</span><span class="s4">, </span><span class="s1">col </span><span class="s3">in </span><span class="s1">cells</span><span class="s4">:</span>
            <span class="s3">del </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">)]</span>


    <span class="s3">def </span><span class="s1">append</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">iterable</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Appends a group of values at the bottom of the current sheet. 
 
        * If it's a list: all values are added in order, starting from the first column 
        * If it's a dict: values are assigned to the columns indicated by the keys (numbers or letters) 
 
        :param iterable: list, range or generator, or dict containing values to append 
        :type iterable: list|tuple|range|generator or dict 
 
        Usage: 
 
        * append(['This is A1', 'This is B1', 'This is C1']) 
        * **or** append({'A' : 'This is A1', 'C' : 'This is C1'}) 
        * **or** append({1 : 'This is A1', 3 : 'This is C1'}) 
 
        :raise: TypeError when iterable is neither a list/tuple nor a dict 
 
        &quot;&quot;&quot;</span>
        <span class="s1">row_idx </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">+ </span><span class="s6">1</span>

        <span class="s3">if </span><span class="s4">(</span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">iterable</span><span class="s4">, (</span><span class="s1">list</span><span class="s4">, </span><span class="s1">tuple</span><span class="s4">, </span><span class="s1">range</span><span class="s4">))</span>
            <span class="s3">or </span><span class="s1">isgenerator</span><span class="s4">(</span><span class="s1">iterable</span><span class="s4">)):</span>
            <span class="s3">for </span><span class="s1">col_idx</span><span class="s4">, </span><span class="s1">content </span><span class="s3">in </span><span class="s1">enumerate</span><span class="s4">(</span><span class="s1">iterable</span><span class="s4">, </span><span class="s6">1</span><span class="s4">):</span>
                <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">content</span><span class="s4">, </span><span class="s1">Cell</span><span class="s4">):</span>
                    <span class="s0"># compatible with write-only mode</span>
                    <span class="s1">cell </span><span class="s4">= </span><span class="s1">content</span>
                    <span class="s3">if </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">parent </span><span class="s3">and </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">parent </span><span class="s4">!= </span><span class="s1">self</span><span class="s4">:</span>
                        <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Cells cannot be copied from other worksheets&quot;</span><span class="s4">)</span>
                    <span class="s1">cell</span><span class="s4">.</span><span class="s1">parent </span><span class="s4">= </span><span class="s1">self</span>
                    <span class="s1">cell</span><span class="s4">.</span><span class="s1">column </span><span class="s4">= </span><span class="s1">col_idx</span>
                    <span class="s1">cell</span><span class="s4">.</span><span class="s1">row </span><span class="s4">= </span><span class="s1">row_idx</span>
                <span class="s3">else</span><span class="s4">:</span>
                    <span class="s1">cell </span><span class="s4">= </span><span class="s1">Cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">row</span><span class="s4">=</span><span class="s1">row_idx</span><span class="s4">, </span><span class="s1">column</span><span class="s4">=</span><span class="s1">col_idx</span><span class="s4">, </span><span class="s1">value</span><span class="s4">=</span><span class="s1">content</span><span class="s4">)</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[(</span><span class="s1">row_idx</span><span class="s4">, </span><span class="s1">col_idx</span><span class="s4">)] = </span><span class="s1">cell</span>

        <span class="s3">elif </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">iterable</span><span class="s4">, </span><span class="s1">dict</span><span class="s4">):</span>
            <span class="s3">for </span><span class="s1">col_idx</span><span class="s4">, </span><span class="s1">content </span><span class="s3">in </span><span class="s1">iterable</span><span class="s4">.</span><span class="s1">items</span><span class="s4">():</span>
                <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">col_idx</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
                    <span class="s1">col_idx </span><span class="s4">= </span><span class="s1">column_index_from_string</span><span class="s4">(</span><span class="s1">col_idx</span><span class="s4">)</span>
                <span class="s1">cell </span><span class="s4">= </span><span class="s1">Cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">row</span><span class="s4">=</span><span class="s1">row_idx</span><span class="s4">, </span><span class="s1">column</span><span class="s4">=</span><span class="s1">col_idx</span><span class="s4">, </span><span class="s1">value</span><span class="s4">=</span><span class="s1">content</span><span class="s4">)</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[(</span><span class="s1">row_idx</span><span class="s4">, </span><span class="s1">col_idx</span><span class="s4">)] = </span><span class="s1">cell</span>

        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_invalid_row</span><span class="s4">(</span><span class="s1">iterable</span><span class="s4">)</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">= </span><span class="s1">row_idx</span>


    <span class="s3">def </span><span class="s1">_move_cells</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">min_row</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">min_col</span><span class="s4">=</span><span class="s3">None</span><span class="s4">, </span><span class="s1">offset</span><span class="s4">=</span><span class="s6">0</span><span class="s4">, </span><span class="s1">row_or_col</span><span class="s4">=</span><span class="s5">&quot;row&quot;</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Move either rows or columns around by the offset 
        &quot;&quot;&quot;</span>
        <span class="s1">reverse </span><span class="s4">= </span><span class="s1">offset </span><span class="s4">&gt; </span><span class="s6">0 </span><span class="s0"># start at the end if inserting</span>
        <span class="s1">row_offset </span><span class="s4">= </span><span class="s6">0</span>
        <span class="s1">col_offset </span><span class="s4">= </span><span class="s6">0</span>

        <span class="s0"># need to make affected ranges contiguous</span>
        <span class="s3">if </span><span class="s1">row_or_col </span><span class="s4">== </span><span class="s5">'row'</span><span class="s4">:</span>
            <span class="s1">cells </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_rows</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">=</span><span class="s1">min_row</span><span class="s4">)</span>
            <span class="s1">row_offset </span><span class="s4">= </span><span class="s1">offset</span>
            <span class="s1">key </span><span class="s4">= </span><span class="s6">0</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">cells </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">iter_cols</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">=</span><span class="s1">min_col</span><span class="s4">)</span>
            <span class="s1">col_offset </span><span class="s4">= </span><span class="s1">offset</span>
            <span class="s1">key </span><span class="s4">= </span><span class="s6">1</span>
        <span class="s1">cells </span><span class="s4">= </span><span class="s1">list</span><span class="s4">(</span><span class="s1">cells</span><span class="s4">)</span>

        <span class="s3">for </span><span class="s1">row</span><span class="s4">, </span><span class="s1">column </span><span class="s3">in </span><span class="s1">sorted</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">, </span><span class="s1">key</span><span class="s4">=</span><span class="s1">itemgetter</span><span class="s4">(</span><span class="s1">key</span><span class="s4">), </span><span class="s1">reverse</span><span class="s4">=</span><span class="s1">reverse</span><span class="s4">):</span>
            <span class="s3">if </span><span class="s1">min_row </span><span class="s3">and </span><span class="s1">row </span><span class="s4">&lt; </span><span class="s1">min_row</span><span class="s4">:</span>
                <span class="s3">continue</span>
            <span class="s3">elif </span><span class="s1">min_col </span><span class="s3">and </span><span class="s1">column </span><span class="s4">&lt; </span><span class="s1">min_col</span><span class="s4">:</span>
                <span class="s3">continue</span>

            <span class="s1">self</span><span class="s4">.</span><span class="s1">_move_cell</span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">, </span><span class="s1">row_offset</span><span class="s4">, </span><span class="s1">col_offset</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">insert_rows</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">idx</span><span class="s4">, </span><span class="s1">amount</span><span class="s4">=</span><span class="s6">1</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Insert row or rows before row==idx 
        &quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_move_cells</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">=</span><span class="s1">idx</span><span class="s4">, </span><span class="s1">offset</span><span class="s4">=</span><span class="s1">amount</span><span class="s4">, </span><span class="s1">row_or_col</span><span class="s4">=</span><span class="s5">&quot;row&quot;</span><span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_row</span>


    <span class="s3">def </span><span class="s1">insert_cols</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">idx</span><span class="s4">, </span><span class="s1">amount</span><span class="s4">=</span><span class="s6">1</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Insert column or columns before col==idx 
        &quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_move_cells</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">=</span><span class="s1">idx</span><span class="s4">, </span><span class="s1">offset</span><span class="s4">=</span><span class="s1">amount</span><span class="s4">, </span><span class="s1">row_or_col</span><span class="s4">=</span><span class="s5">&quot;column&quot;</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">delete_rows</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">idx</span><span class="s4">, </span><span class="s1">amount</span><span class="s4">=</span><span class="s6">1</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Delete row or rows from row==idx 
        &quot;&quot;&quot;</span>

        <span class="s1">remainder </span><span class="s4">= </span><span class="s1">_gutter</span><span class="s4">(</span><span class="s1">idx</span><span class="s4">, </span><span class="s1">amount</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_row</span><span class="s4">)</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">_move_cells</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">=</span><span class="s1">idx</span><span class="s4">+</span><span class="s1">amount</span><span class="s4">, </span><span class="s1">offset</span><span class="s4">=-</span><span class="s1">amount</span><span class="s4">, </span><span class="s1">row_or_col</span><span class="s4">=</span><span class="s5">&quot;row&quot;</span><span class="s4">)</span>

        <span class="s0"># calculating min and max col is an expensive operation, do it only once</span>
        <span class="s1">min_col </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">min_column</span>
        <span class="s1">max_col </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_column </span><span class="s4">+ </span><span class="s6">1</span>
        <span class="s3">for </span><span class="s1">row </span><span class="s3">in </span><span class="s1">remainder</span><span class="s4">:</span>
            <span class="s3">for </span><span class="s1">col </span><span class="s3">in </span><span class="s1">range</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">, </span><span class="s1">max_col</span><span class="s4">):</span>
                <span class="s3">if </span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">) </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
                    <span class="s3">del </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[</span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">]</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_row</span>
        <span class="s3">if not </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_current_row </span><span class="s4">= </span><span class="s6">0</span>


    <span class="s3">def </span><span class="s1">delete_cols</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">idx</span><span class="s4">, </span><span class="s1">amount</span><span class="s4">=</span><span class="s6">1</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Delete column or columns from col==idx 
        &quot;&quot;&quot;</span>

        <span class="s1">remainder </span><span class="s4">= </span><span class="s1">_gutter</span><span class="s4">(</span><span class="s1">idx</span><span class="s4">, </span><span class="s1">amount</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_column</span><span class="s4">)</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">_move_cells</span><span class="s4">(</span><span class="s1">min_col</span><span class="s4">=</span><span class="s1">idx</span><span class="s4">+</span><span class="s1">amount</span><span class="s4">, </span><span class="s1">offset</span><span class="s4">=-</span><span class="s1">amount</span><span class="s4">, </span><span class="s1">row_or_col</span><span class="s4">=</span><span class="s5">&quot;column&quot;</span><span class="s4">)</span>

        <span class="s0"># calculating min and max row is an expensive operation, do it only once</span>
        <span class="s1">min_row </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">min_row</span>
        <span class="s1">max_row </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">max_row </span><span class="s4">+ </span><span class="s6">1</span>
        <span class="s3">for </span><span class="s1">col </span><span class="s3">in </span><span class="s1">remainder</span><span class="s4">:</span>
            <span class="s3">for </span><span class="s1">row </span><span class="s3">in </span><span class="s1">range</span><span class="s4">(</span><span class="s1">min_row</span><span class="s4">, </span><span class="s1">max_row</span><span class="s4">):</span>
                <span class="s3">if </span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">) </span><span class="s3">in </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">:</span>
                    <span class="s3">del </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[</span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">]</span>


    <span class="s3">def </span><span class="s1">move_range</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">cell_range</span><span class="s4">, </span><span class="s1">rows</span><span class="s4">=</span><span class="s6">0</span><span class="s4">, </span><span class="s1">cols</span><span class="s4">=</span><span class="s6">0</span><span class="s4">, </span><span class="s1">translate</span><span class="s4">=</span><span class="s3">False</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Move a cell range by the number of rows and/or columns: 
        down if rows &gt; 0 and up if rows &lt; 0 
        right if cols &gt; 0 and left if cols &lt; 0 
        Existing cells will be overwritten. 
        Formulae and references will not be updated. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">cell_range</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
            <span class="s1">cell_range </span><span class="s4">= </span><span class="s1">CellRange</span><span class="s4">(</span><span class="s1">cell_range</span><span class="s4">)</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">cell_range</span><span class="s4">, </span><span class="s1">CellRange</span><span class="s4">):</span>
            <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;Only CellRange objects can be moved&quot;</span><span class="s4">)</span>
        <span class="s3">if not </span><span class="s1">rows </span><span class="s3">and not </span><span class="s1">cols</span><span class="s4">:</span>
            <span class="s3">return</span>

        <span class="s1">down </span><span class="s4">= </span><span class="s1">rows </span><span class="s4">&gt; </span><span class="s6">0</span>
        <span class="s1">right </span><span class="s4">= </span><span class="s1">cols </span><span class="s4">&gt; </span><span class="s6">0</span>

        <span class="s3">if </span><span class="s1">rows</span><span class="s4">:</span>
            <span class="s1">cells </span><span class="s4">= </span><span class="s1">sorted</span><span class="s4">(</span><span class="s1">cell_range</span><span class="s4">.</span><span class="s1">rows</span><span class="s4">, </span><span class="s1">reverse</span><span class="s4">=</span><span class="s1">down</span><span class="s4">)</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">cells </span><span class="s4">= </span><span class="s1">sorted</span><span class="s4">(</span><span class="s1">cell_range</span><span class="s4">.</span><span class="s1">cols</span><span class="s4">, </span><span class="s1">reverse</span><span class="s4">=</span><span class="s1">right</span><span class="s4">)</span>

        <span class="s3">for </span><span class="s1">row</span><span class="s4">, </span><span class="s1">col </span><span class="s3">in </span><span class="s1">chain</span><span class="s4">.</span><span class="s1">from_iterable</span><span class="s4">(</span><span class="s1">cells</span><span class="s4">):</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_move_cell</span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">col</span><span class="s4">, </span><span class="s1">rows</span><span class="s4">, </span><span class="s1">cols</span><span class="s4">, </span><span class="s1">translate</span><span class="s4">)</span>

        <span class="s0"># rebase moved range</span>
        <span class="s1">cell_range</span><span class="s4">.</span><span class="s1">shift</span><span class="s4">(</span><span class="s1">row_shift</span><span class="s4">=</span><span class="s1">rows</span><span class="s4">, </span><span class="s1">col_shift</span><span class="s4">=</span><span class="s1">cols</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">_move_cell</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">, </span><span class="s1">row_offset</span><span class="s4">, </span><span class="s1">col_offset</span><span class="s4">, </span><span class="s1">translate</span><span class="s4">=</span><span class="s3">False</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Move a cell from one place to another. 
        Delete at old index 
        Rebase coordinate 
        &quot;&quot;&quot;</span>
        <span class="s1">cell </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_get_cell</span><span class="s4">(</span><span class="s1">row</span><span class="s4">, </span><span class="s1">column</span><span class="s4">)</span>
        <span class="s1">new_row </span><span class="s4">= </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">row </span><span class="s4">+ </span><span class="s1">row_offset</span>
        <span class="s1">new_col </span><span class="s4">= </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">column </span><span class="s4">+ </span><span class="s1">col_offset</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[</span><span class="s1">new_row</span><span class="s4">, </span><span class="s1">new_col</span><span class="s4">] = </span><span class="s1">cell</span>
        <span class="s3">del </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_cells</span><span class="s4">[(</span><span class="s1">cell</span><span class="s4">.</span><span class="s1">row</span><span class="s4">, </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">column</span><span class="s4">)]</span>
        <span class="s1">cell</span><span class="s4">.</span><span class="s1">row </span><span class="s4">= </span><span class="s1">new_row</span>
        <span class="s1">cell</span><span class="s4">.</span><span class="s1">column </span><span class="s4">= </span><span class="s1">new_col</span>
        <span class="s3">if </span><span class="s1">translate </span><span class="s3">and </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">data_type </span><span class="s4">== </span><span class="s5">&quot;f&quot;</span><span class="s4">:</span>
            <span class="s1">t </span><span class="s4">= </span><span class="s1">Translator</span><span class="s4">(</span><span class="s1">cell</span><span class="s4">.</span><span class="s1">value</span><span class="s4">, </span><span class="s1">cell</span><span class="s4">.</span><span class="s1">coordinate</span><span class="s4">)</span>
            <span class="s1">cell</span><span class="s4">.</span><span class="s1">value </span><span class="s4">= </span><span class="s1">t</span><span class="s4">.</span><span class="s1">translate_formula</span><span class="s4">(</span><span class="s1">row_delta</span><span class="s4">=</span><span class="s1">row_offset</span><span class="s4">, </span><span class="s1">col_delta</span><span class="s4">=</span><span class="s1">col_offset</span><span class="s4">)</span>


    <span class="s3">def </span><span class="s1">_invalid_row</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">iterable</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">'Value must be a list, tuple, range or generator, or a dict. Supplied value is {0}'</span><span class="s4">.</span><span class="s1">format</span><span class="s4">(</span>
            <span class="s1">type</span><span class="s4">(</span><span class="s1">iterable</span><span class="s4">))</span>
                        <span class="s4">)</span>


    <span class="s3">def </span><span class="s1">_add_column</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Dimension factory for column information&quot;&quot;&quot;</span>

        <span class="s3">return </span><span class="s1">ColumnDimension</span><span class="s4">(</span><span class="s1">self</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">_add_row</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Dimension factory for row information&quot;&quot;&quot;</span>

        <span class="s3">return </span><span class="s1">RowDimension</span><span class="s4">(</span><span class="s1">self</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">print_title_rows</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Rows to be printed at the top of every page (ex: '1:3')&quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_print_rows</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">str</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_print_rows</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">print_title_rows</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">print_title_rows</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">rows</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Set rows to be printed on the top of every page 
        format `1:3` 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">rows </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_rows </span><span class="s4">= </span><span class="s1">RowRange</span><span class="s4">(</span><span class="s1">rows</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">print_title_cols</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Columns to be printed at the left side of every page (ex: 'A:C')&quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_print_cols</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">str</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_print_cols</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">print_title_cols</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">print_title_cols</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">cols</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Set cols to be printed on the left of every page 
        format ``A:C` 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">cols </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_cols </span><span class="s4">= </span><span class="s1">ColRange</span><span class="s4">(</span><span class="s1">cols</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">print_titles</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s1">titles </span><span class="s4">= </span><span class="s1">PrintTitles</span><span class="s4">(</span><span class="s1">cols</span><span class="s4">=</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_print_cols</span><span class="s4">, </span><span class="s1">rows</span><span class="s4">=</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_print_rows</span><span class="s4">, </span><span class="s1">title</span><span class="s4">=</span><span class="s1">self</span><span class="s4">.</span><span class="s1">title</span><span class="s4">)</span>
        <span class="s3">return </span><span class="s1">str</span><span class="s4">(</span><span class="s1">titles</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">property</span>
    <span class="s3">def </span><span class="s1">print_area</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        The print area for the worksheet, or None if not set. To set, supply a range 
        like 'A1:D4' or a list of ranges. 
        &quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_area</span><span class="s4">.</span><span class="s1">title </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">title</span>
        <span class="s3">return </span><span class="s1">str</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">_print_area</span><span class="s4">)</span>


    <span class="s4">@</span><span class="s1">print_area</span><span class="s4">.</span><span class="s1">setter</span>
    <span class="s3">def </span><span class="s1">print_area</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">value</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot; 
        Range of cells in the form A1:D4 or list of ranges. Print area can be cleared 
        by passing `None` or an empty list 
        &quot;&quot;&quot;</span>
        <span class="s3">if not </span><span class="s1">value</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_area </span><span class="s4">= </span><span class="s1">PrintArea</span><span class="s4">()</span>
        <span class="s3">elif </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, </span><span class="s1">str</span><span class="s4">):</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_area </span><span class="s4">= </span><span class="s1">PrintArea</span><span class="s4">.</span><span class="s1">from_string</span><span class="s4">(</span><span class="s1">value</span><span class="s4">)</span>
        <span class="s3">elif </span><span class="s1">hasattr</span><span class="s4">(</span><span class="s1">value</span><span class="s4">, </span><span class="s5">&quot;__iter__&quot;</span><span class="s4">):</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">_print_area </span><span class="s4">= </span><span class="s1">PrintArea</span><span class="s4">.</span><span class="s1">from_string</span><span class="s4">(</span><span class="s5">&quot;,&quot;</span><span class="s4">.</span><span class="s1">join</span><span class="s4">(</span><span class="s1">value</span><span class="s4">))</span>


<span class="s3">def </span><span class="s1">_gutter</span><span class="s4">(</span><span class="s1">idx</span><span class="s4">, </span><span class="s1">offset</span><span class="s4">, </span><span class="s1">max_val</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot; 
    When deleting rows and columns are deleted we rely on overwriting. 
    This may not be the case for a large offset on small set of cells: 
    range(cells_to_delete) &gt; range(cell_to_be_moved) 
    &quot;&quot;&quot;</span>
    <span class="s1">gutter </span><span class="s4">= </span><span class="s1">range</span><span class="s4">(</span><span class="s1">max</span><span class="s4">(</span><span class="s1">max_val</span><span class="s4">+</span><span class="s6">1</span><span class="s4">-</span><span class="s1">offset</span><span class="s4">, </span><span class="s1">idx</span><span class="s4">), </span><span class="s1">min</span><span class="s4">(</span><span class="s1">idx</span><span class="s4">+</span><span class="s1">offset</span><span class="s4">, </span><span class="s1">max_val</span><span class="s4">)+</span><span class="s6">1</span><span class="s4">)</span>
    <span class="s3">return </span><span class="s1">gutter</span>
</pre>
</body>
</html>