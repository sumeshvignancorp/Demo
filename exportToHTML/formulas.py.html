<html>
<head>
<title>formulas.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #5f826b; font-style: italic;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #cf8e6d;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
formulas.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright (c) 2010-2023 openpyxl</span>

<span class="s2">&quot;&quot;&quot; 
List of builtin formulae 
&quot;&quot;&quot;</span>

<span class="s1">FORMULAE </span><span class="s3">= (</span><span class="s4">&quot;CUBEKPIMEMBER&quot;</span><span class="s3">, </span><span class="s4">&quot;CUBEMEMBER&quot;</span><span class="s3">, </span><span class="s4">&quot;CUBEMEMBERPROPERTY&quot;</span><span class="s3">, </span><span class="s4">&quot;CUBERANKEDMEMBER&quot;</span><span class="s3">, </span><span class="s4">&quot;CUBESET&quot;</span><span class="s3">, </span><span class="s4">&quot;CUBESETCOUNT&quot;</span><span class="s3">, </span><span class="s4">&quot;CUBEVALUE&quot;</span><span class="s3">, </span><span class="s4">&quot;DAVERAGE&quot;</span><span class="s3">, </span><span class="s4">&quot;DCOUNT&quot;</span><span class="s3">, </span><span class="s4">&quot;DCOUNTA&quot;</span><span class="s3">, </span><span class="s4">&quot;DGET&quot;</span><span class="s3">, </span><span class="s4">&quot;DMAX&quot;</span><span class="s3">, </span><span class="s4">&quot;DMIN&quot;</span><span class="s3">, </span><span class="s4">&quot;DPRODUCT&quot;</span><span class="s3">, </span><span class="s4">&quot;DSTDEV&quot;</span><span class="s3">, </span><span class="s4">&quot;DSTDEVP&quot;</span><span class="s3">, </span><span class="s4">&quot;DSUM&quot;</span><span class="s3">, </span><span class="s4">&quot;DVAR&quot;</span><span class="s3">, </span><span class="s4">&quot;DVARP&quot;</span><span class="s3">, </span><span class="s4">&quot;DATE&quot;</span><span class="s3">, </span><span class="s4">&quot;DATEDIF&quot;</span><span class="s3">, </span><span class="s4">&quot;DATEVALUE&quot;</span><span class="s3">, </span><span class="s4">&quot;DAY&quot;</span><span class="s3">, </span><span class="s4">&quot;DAYS360&quot;</span><span class="s3">, </span><span class="s4">&quot;EDATE&quot;</span><span class="s3">, </span><span class="s4">&quot;EOMONTH&quot;</span><span class="s3">, </span><span class="s4">&quot;HOUR&quot;</span><span class="s3">, </span><span class="s4">&quot;MINUTE&quot;</span><span class="s3">, </span><span class="s4">&quot;MONTH&quot;</span><span class="s3">, </span><span class="s4">&quot;NETWORKDAYS&quot;</span><span class="s3">, </span><span class="s4">&quot;NETWORKDAYS.INTL&quot;</span><span class="s3">, </span><span class="s4">&quot;NOW&quot;</span><span class="s3">, </span><span class="s4">&quot;SECOND&quot;</span><span class="s3">, </span><span class="s4">&quot;TIME&quot;</span><span class="s3">, </span><span class="s4">&quot;TIMEVALUE&quot;</span><span class="s3">, </span><span class="s4">&quot;TODAY&quot;</span><span class="s3">, </span><span class="s4">&quot;WEEKDAY&quot;</span><span class="s3">, </span><span class="s4">&quot;WEEKNUM&quot;</span><span class="s3">, </span><span class="s4">&quot;WORKDAY &quot;</span><span class="s3">, </span><span class="s4">&quot;WORKDAY.INTL&quot;</span><span class="s3">, </span><span class="s4">&quot;YEAR&quot;</span><span class="s3">, </span><span class="s4">&quot;YEARFRAC&quot;</span><span class="s3">, </span><span class="s4">&quot;BESSELI&quot;</span><span class="s3">, </span><span class="s4">&quot;BESSELJ&quot;</span><span class="s3">, </span><span class="s4">&quot;BESSELK&quot;</span><span class="s3">, </span><span class="s4">&quot;BESSELY&quot;</span><span class="s3">, </span><span class="s4">&quot;BIN2DEC&quot;</span><span class="s3">, </span><span class="s4">&quot;BIN2HEX&quot;</span><span class="s3">, </span><span class="s4">&quot;BIN2OCT&quot;</span><span class="s3">, </span><span class="s4">&quot;COMPLEX&quot;</span><span class="s3">, </span><span class="s4">&quot;CONVERT&quot;</span><span class="s3">, </span><span class="s4">&quot;DEC2BIN&quot;</span><span class="s3">, </span><span class="s4">&quot;DEC2HEX&quot;</span><span class="s3">, </span><span class="s4">&quot;DEC2OCT&quot;</span><span class="s3">, </span><span class="s4">&quot;DELTA&quot;</span><span class="s3">, </span><span class="s4">&quot;ERF&quot;</span><span class="s3">, </span><span class="s4">&quot;ERFC&quot;</span><span class="s3">, </span><span class="s4">&quot;GESTEP&quot;</span><span class="s3">, </span><span class="s4">&quot;HEX2BIN&quot;</span><span class="s3">, </span><span class="s4">&quot;HEX2DEC&quot;</span><span class="s3">, </span><span class="s4">&quot;HEX2OCT&quot;</span><span class="s3">, </span><span class="s4">&quot;IMABS&quot;</span><span class="s3">, </span><span class="s4">&quot;IMAGINARY&quot;</span><span class="s3">, </span><span class="s4">&quot;IMARGUMENT&quot;</span><span class="s3">, </span><span class="s4">&quot;IMCONJUGATE&quot;</span><span class="s3">, </span><span class="s4">&quot;IMCOS&quot;</span><span class="s3">, </span><span class="s4">&quot;IMDIV&quot;</span><span class="s3">, </span><span class="s4">&quot;IMEXP&quot;</span><span class="s3">, </span><span class="s4">&quot;IMLN&quot;</span><span class="s3">, </span><span class="s4">&quot;IMLOG10&quot;</span><span class="s3">, </span><span class="s4">&quot;IMLOG2&quot;</span><span class="s3">, </span><span class="s4">&quot;IMPOWER&quot;</span><span class="s3">, </span><span class="s4">&quot;IMPRODUCT&quot;</span><span class="s3">, </span><span class="s4">&quot;IMREAL&quot;</span><span class="s3">, </span><span class="s4">&quot;IMSIN&quot;</span><span class="s3">, </span><span class="s4">&quot;IMSQRT&quot;</span><span class="s3">, </span><span class="s4">&quot;IMSUB&quot;</span><span class="s3">, </span><span class="s4">&quot;IMSUM&quot;</span><span class="s3">, </span><span class="s4">&quot;OCT2BIN&quot;</span><span class="s3">, </span><span class="s4">&quot;OCT2DEC&quot;</span><span class="s3">, </span><span class="s4">&quot;OCT2HEX&quot;</span><span class="s3">, </span><span class="s4">&quot;ACCRINT&quot;</span><span class="s3">, </span><span class="s4">&quot;ACCRINTM&quot;</span><span class="s3">, </span><span class="s4">&quot;AMORDEGRC&quot;</span><span class="s3">, </span><span class="s4">&quot;AMORLINC&quot;</span><span class="s3">, </span><span class="s4">&quot;COUPDAYBS&quot;</span><span class="s3">, </span><span class="s4">&quot;COUPDAYS&quot;</span><span class="s3">, </span><span class="s4">&quot;COUPDAYSNC&quot;</span><span class="s3">, </span><span class="s4">&quot;COUPNCD&quot;</span><span class="s3">, </span><span class="s4">&quot;COUPNUM&quot;</span><span class="s3">, </span><span class="s4">&quot;COUPPCD&quot;</span><span class="s3">, </span><span class="s4">&quot;CUMIPMT&quot;</span><span class="s3">, </span><span class="s4">&quot;CUMPRINC&quot;</span><span class="s3">, </span><span class="s4">&quot;DB&quot;</span><span class="s3">, </span><span class="s4">&quot;DDB&quot;</span><span class="s3">, </span><span class="s4">&quot;DISC&quot;</span><span class="s3">, </span><span class="s4">&quot;DOLLARDE&quot;</span><span class="s3">, </span><span class="s4">&quot;DOLLARFR&quot;</span><span class="s3">, </span><span class="s4">&quot;DURATION&quot;</span><span class="s3">, </span><span class="s4">&quot;EFFECT&quot;</span><span class="s3">, </span><span class="s4">&quot;FV&quot;</span><span class="s3">, </span><span class="s4">&quot;FVSCHEDULE&quot;</span><span class="s3">, </span><span class="s4">&quot;INTRATE&quot;</span><span class="s3">, </span><span class="s4">&quot;IPMT&quot;</span><span class="s3">, </span><span class="s4">&quot;IRR&quot;</span><span class="s3">, </span><span class="s4">&quot;ISPMT&quot;</span><span class="s3">, </span><span class="s4">&quot;MDURATION&quot;</span><span class="s3">, </span><span class="s4">&quot;MIRR&quot;</span><span class="s3">, </span><span class="s4">&quot;NOMINAL&quot;</span><span class="s3">, </span><span class="s4">&quot;NPER&quot;</span><span class="s3">, </span><span class="s4">&quot;NPV&quot;</span><span class="s3">, </span><span class="s4">&quot;ODDFPRICE&quot;</span><span class="s3">, </span><span class="s4">&quot;ODDFYIELD&quot;</span><span class="s3">, </span><span class="s4">&quot;ODDLPRICE&quot;</span><span class="s3">, </span><span class="s4">&quot;ODDLYIELD&quot;</span><span class="s3">, </span><span class="s4">&quot;PMT&quot;</span><span class="s3">, </span><span class="s4">&quot;PPMT&quot;</span><span class="s3">, </span><span class="s4">&quot;PRICE&quot;</span><span class="s3">, </span><span class="s4">&quot;PRICEDISC&quot;</span><span class="s3">, </span><span class="s4">&quot;PRICEMAT&quot;</span><span class="s3">, </span><span class="s4">&quot;PV&quot;</span><span class="s3">, </span><span class="s4">&quot;RATE&quot;</span><span class="s3">, </span><span class="s4">&quot;RECEIVED&quot;</span><span class="s3">, </span><span class="s4">&quot;SLN&quot;</span><span class="s3">, </span><span class="s4">&quot;SYD&quot;</span><span class="s3">, </span><span class="s4">&quot;TBILLEQ&quot;</span><span class="s3">, </span><span class="s4">&quot;TBILLPRICE&quot;</span><span class="s3">, </span><span class="s4">&quot;TBILLYIELD&quot;</span><span class="s3">, </span><span class="s4">&quot;VDB&quot;</span><span class="s3">, </span><span class="s4">&quot;XIRR&quot;</span><span class="s3">, </span><span class="s4">&quot;XNPV&quot;</span><span class="s3">, </span><span class="s4">&quot;YIELD&quot;</span><span class="s3">, </span><span class="s4">&quot;YIELDDISC&quot;</span><span class="s3">, </span><span class="s4">&quot;YIELDMAT&quot;</span><span class="s3">, </span><span class="s4">&quot;CELL&quot;</span><span class="s3">, </span><span class="s4">&quot;ERROR.TYPE&quot;</span><span class="s3">, </span><span class="s4">&quot;INFO&quot;</span><span class="s3">, </span><span class="s4">&quot;ISBLANK&quot;</span><span class="s3">, </span><span class="s4">&quot;ISERR&quot;</span><span class="s3">, </span><span class="s4">&quot;ISERROR&quot;</span><span class="s3">, </span><span class="s4">&quot;ISEVEN&quot;</span><span class="s3">, </span><span class="s4">&quot;ISLOGICAL&quot;</span><span class="s3">, </span><span class="s4">&quot;ISNA&quot;</span><span class="s3">, </span><span class="s4">&quot;ISNONTEXT&quot;</span><span class="s3">, </span><span class="s4">&quot;ISNUMBER&quot;</span><span class="s3">, </span><span class="s4">&quot;ISODD&quot;</span><span class="s3">, </span><span class="s4">&quot;ISREF&quot;</span><span class="s3">, </span><span class="s4">&quot;ISTEXT&quot;</span><span class="s3">, </span><span class="s4">&quot;N&quot;</span><span class="s3">, </span><span class="s4">&quot;NA&quot;</span><span class="s3">, </span><span class="s4">&quot;TYPE&quot;</span><span class="s3">, </span><span class="s4">&quot;AND&quot;</span><span class="s3">, </span><span class="s4">&quot;FALSE&quot;</span><span class="s3">, </span><span class="s4">&quot;IF&quot;</span><span class="s3">, </span><span class="s4">&quot;IFERROR&quot;</span><span class="s3">, </span><span class="s4">&quot;NOT&quot;</span><span class="s3">, </span><span class="s4">&quot;OR&quot;</span><span class="s3">, </span><span class="s4">&quot;TRUE ADDRESS&quot;</span><span class="s3">, </span><span class="s4">&quot;AREAS&quot;</span><span class="s3">, </span><span class="s4">&quot;CHOOSE&quot;</span><span class="s3">, </span><span class="s4">&quot;COLUMN&quot;</span><span class="s3">, </span><span class="s4">&quot;COLUMNS&quot;</span><span class="s3">, </span><span class="s4">&quot;GETPIVOTDATA&quot;</span><span class="s3">, </span><span class="s4">&quot;HLOOKUP&quot;</span><span class="s3">, </span><span class="s4">&quot;HYPERLINK&quot;</span><span class="s3">, </span><span class="s4">&quot;INDEX&quot;</span><span class="s3">, </span><span class="s4">&quot;INDIRECT&quot;</span><span class="s3">, </span><span class="s4">&quot;LOOKUP&quot;</span><span class="s3">, </span><span class="s4">&quot;MATCH&quot;</span><span class="s3">, </span><span class="s4">&quot;OFFSET&quot;</span><span class="s3">, </span><span class="s4">&quot;ROW&quot;</span><span class="s3">, </span><span class="s4">&quot;ROWS&quot;</span><span class="s3">, </span><span class="s4">&quot;RTD&quot;</span><span class="s3">, </span><span class="s4">&quot;TRANSPOSE&quot;</span><span class="s3">, </span><span class="s4">&quot;VLOOKUP&quot;</span><span class="s3">, </span><span class="s4">&quot;ABS&quot;</span><span class="s3">, </span><span class="s4">&quot;ACOS&quot;</span><span class="s3">, </span><span class="s4">&quot;ACOSH&quot;</span><span class="s3">, </span><span class="s4">&quot;ASIN&quot;</span><span class="s3">, </span><span class="s4">&quot;ASINH&quot;</span><span class="s3">, </span><span class="s4">&quot;ATAN&quot;</span><span class="s3">, </span><span class="s4">&quot;ATAN2&quot;</span><span class="s3">, </span><span class="s4">&quot;ATANH&quot;</span><span class="s3">, </span><span class="s4">&quot;CEILING&quot;</span><span class="s3">, </span><span class="s4">&quot;COMBIN&quot;</span><span class="s3">, </span><span class="s4">&quot;COS&quot;</span><span class="s3">, </span><span class="s4">&quot;COSH&quot;</span><span class="s3">, </span><span class="s4">&quot;DEGREES&quot;</span><span class="s3">, </span><span class="s4">&quot;ECMA.CEILING&quot;</span><span class="s3">, </span><span class="s4">&quot;EVEN&quot;</span><span class="s3">, </span><span class="s4">&quot;EXP&quot;</span><span class="s3">, </span><span class="s4">&quot;FACT&quot;</span><span class="s3">, </span><span class="s4">&quot;FACTDOUBLE&quot;</span><span class="s3">, </span><span class="s4">&quot;FLOOR&quot;</span><span class="s3">, </span><span class="s4">&quot;GCD&quot;</span><span class="s3">, </span><span class="s4">&quot;INT&quot;</span><span class="s3">, </span><span class="s4">&quot;ISO.CEILING&quot;</span><span class="s3">, </span><span class="s4">&quot;LCM&quot;</span><span class="s3">, </span><span class="s4">&quot;LN&quot;</span><span class="s3">, </span><span class="s4">&quot;LOG&quot;</span><span class="s3">, </span><span class="s4">&quot;LOG10&quot;</span><span class="s3">, </span><span class="s4">&quot;MDETERM&quot;</span><span class="s3">, </span><span class="s4">&quot;MINVERSE&quot;</span><span class="s3">, </span><span class="s4">&quot;MMULT&quot;</span><span class="s3">, </span><span class="s4">&quot;MOD&quot;</span><span class="s3">, </span><span class="s4">&quot;MROUND&quot;</span><span class="s3">, </span><span class="s4">&quot;MULTINOMIAL&quot;</span><span class="s3">, </span><span class="s4">&quot;ODD&quot;</span><span class="s3">, </span><span class="s4">&quot;PI&quot;</span><span class="s3">, </span><span class="s4">&quot;POWER&quot;</span><span class="s3">, </span><span class="s4">&quot;PRODUCT&quot;</span><span class="s3">, </span><span class="s4">&quot;QUOTIENT&quot;</span><span class="s3">, </span><span class="s4">&quot;RADIANS&quot;</span><span class="s3">, </span><span class="s4">&quot;RAND&quot;</span><span class="s3">, </span><span class="s4">&quot;RANDBETWEEN&quot;</span><span class="s3">, </span><span class="s4">&quot;ROMAN&quot;</span><span class="s3">, </span><span class="s4">&quot;ROUND&quot;</span><span class="s3">, </span><span class="s4">&quot;ROUNDDOWN&quot;</span><span class="s3">, </span><span class="s4">&quot;ROUNDUP&quot;</span><span class="s3">, </span><span class="s4">&quot;SERIESSUM&quot;</span><span class="s3">, </span><span class="s4">&quot;SIGN&quot;</span><span class="s3">, </span><span class="s4">&quot;SIN&quot;</span><span class="s3">, </span><span class="s4">&quot;SINH&quot;</span><span class="s3">, </span><span class="s4">&quot;SQRT&quot;</span><span class="s3">, </span><span class="s4">&quot;SQRTPI&quot;</span><span class="s3">, </span><span class="s4">&quot;SUBTOTAL&quot;</span><span class="s3">, </span><span class="s4">&quot;SUM&quot;</span><span class="s3">, </span><span class="s4">&quot;SUMIF&quot;</span><span class="s3">, </span><span class="s4">&quot;SUMIFS&quot;</span><span class="s3">, </span><span class="s4">&quot;SUMPRODUCT&quot;</span><span class="s3">, </span><span class="s4">&quot;SUMSQ&quot;</span><span class="s3">, </span><span class="s4">&quot;SUMX2MY2&quot;</span><span class="s3">, </span><span class="s4">&quot;SUMX2PY2&quot;</span><span class="s3">, </span><span class="s4">&quot;SUMXMY2&quot;</span><span class="s3">, </span><span class="s4">&quot;TAN&quot;</span><span class="s3">, </span><span class="s4">&quot;TANH&quot;</span><span class="s3">, </span><span class="s4">&quot;TRUNC&quot;</span><span class="s3">, </span><span class="s4">&quot;AVEDEV&quot;</span><span class="s3">, </span><span class="s4">&quot;AVERAGE&quot;</span><span class="s3">, </span><span class="s4">&quot;AVERAGEA&quot;</span><span class="s3">, </span><span class="s4">&quot;AVERAGEIF&quot;</span><span class="s3">, </span><span class="s4">&quot;AVERAGEIFS&quot;</span><span class="s3">, </span><span class="s4">&quot;BETADIST&quot;</span><span class="s3">, </span><span class="s4">&quot;BETAINV&quot;</span><span class="s3">, </span><span class="s4">&quot;BINOMDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;CHIDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;CHIINV&quot;</span><span class="s3">, </span><span class="s4">&quot;CHITEST&quot;</span><span class="s3">, </span><span class="s4">&quot;CONFIDENCE&quot;</span><span class="s3">, </span><span class="s4">&quot;CORREL&quot;</span><span class="s3">, </span><span class="s4">&quot;COUNT&quot;</span><span class="s3">, </span><span class="s4">&quot;COUNTA&quot;</span><span class="s3">, </span><span class="s4">&quot;COUNTBLANK&quot;</span><span class="s3">, </span><span class="s4">&quot;COUNTIF&quot;</span><span class="s3">, </span><span class="s4">&quot;COUNTIFS&quot;</span><span class="s3">, </span><span class="s4">&quot;COVAR&quot;</span><span class="s3">, </span><span class="s4">&quot;CRITBINOM&quot;</span><span class="s3">, </span><span class="s4">&quot;DEVSQ&quot;</span><span class="s3">, </span><span class="s4">&quot;EXPONDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;FDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;FINV&quot;</span><span class="s3">, </span><span class="s4">&quot;FISHER&quot;</span><span class="s3">, </span><span class="s4">&quot;FISHERINV&quot;</span><span class="s3">, </span><span class="s4">&quot;FORECAST&quot;</span><span class="s3">, </span><span class="s4">&quot;FREQUENCY&quot;</span><span class="s3">, </span><span class="s4">&quot;FTEST&quot;</span><span class="s3">, </span><span class="s4">&quot;GAMMADIST&quot;</span><span class="s3">, </span><span class="s4">&quot;GAMMAINV&quot;</span><span class="s3">, </span><span class="s4">&quot;GAMMALN&quot;</span><span class="s3">, </span><span class="s4">&quot;GEOMEAN&quot;</span><span class="s3">, </span><span class="s4">&quot;GROWTH&quot;</span><span class="s3">, </span><span class="s4">&quot;HARMEAN&quot;</span><span class="s3">, </span><span class="s4">&quot;HYPGEOMDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;INTERCEPT&quot;</span><span class="s3">, </span><span class="s4">&quot;KURT&quot;</span><span class="s3">, </span><span class="s4">&quot;LARGE&quot;</span><span class="s3">, </span><span class="s4">&quot;LINEST&quot;</span><span class="s3">, </span><span class="s4">&quot;LOGEST&quot;</span><span class="s3">, </span><span class="s4">&quot;LOGINV&quot;</span><span class="s3">, </span><span class="s4">&quot;LOGNORMDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;MAX&quot;</span><span class="s3">, </span><span class="s4">&quot;MAXA&quot;</span><span class="s3">, </span><span class="s4">&quot;MEDIAN&quot;</span><span class="s3">, </span><span class="s4">&quot;MIN&quot;</span><span class="s3">, </span><span class="s4">&quot;MINA&quot;</span><span class="s3">, </span><span class="s4">&quot;MODE&quot;</span><span class="s3">, </span><span class="s4">&quot;NEGBINOMDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;NORMDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;NORMINV&quot;</span><span class="s3">, </span><span class="s4">&quot;NORMSDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;NORMSINV&quot;</span><span class="s3">, </span><span class="s4">&quot;PEARSON&quot;</span><span class="s3">, </span><span class="s4">&quot;PERCENTILE&quot;</span><span class="s3">, </span><span class="s4">&quot;PERCENTRANK&quot;</span><span class="s3">, </span><span class="s4">&quot;PERMUT&quot;</span><span class="s3">, </span><span class="s4">&quot;POISSON&quot;</span><span class="s3">, </span><span class="s4">&quot;PROB&quot;</span><span class="s3">, </span><span class="s4">&quot;QUARTILE&quot;</span><span class="s3">, </span><span class="s4">&quot;RANK&quot;</span><span class="s3">, </span><span class="s4">&quot;RSQ&quot;</span><span class="s3">, </span><span class="s4">&quot;SKEW&quot;</span><span class="s3">, </span><span class="s4">&quot;SLOPE&quot;</span><span class="s3">, </span><span class="s4">&quot;SMALL&quot;</span><span class="s3">, </span><span class="s4">&quot;STANDARDIZE&quot;</span><span class="s3">, </span><span class="s4">&quot;STDEV STDEVA&quot;</span><span class="s3">, </span><span class="s4">&quot;STDEVP&quot;</span><span class="s3">, </span><span class="s4">&quot;STDEVPA STEYX&quot;</span><span class="s3">, </span><span class="s4">&quot;TDIST&quot;</span><span class="s3">, </span><span class="s4">&quot;TINV&quot;</span><span class="s3">, </span><span class="s4">&quot;TREND&quot;</span><span class="s3">, </span><span class="s4">&quot;TRIMMEAN&quot;</span><span class="s3">, </span><span class="s4">&quot;TTEST&quot;</span><span class="s3">, </span><span class="s4">&quot;VAR&quot;</span><span class="s3">, </span><span class="s4">&quot;VARA&quot;</span><span class="s3">, </span><span class="s4">&quot;VARP&quot;</span><span class="s3">, </span><span class="s4">&quot;VARPA&quot;</span><span class="s3">, </span><span class="s4">&quot;WEIBULL&quot;</span><span class="s3">, </span><span class="s4">&quot;ZTEST&quot;</span><span class="s3">, </span><span class="s4">&quot;ASC&quot;</span><span class="s3">, </span><span class="s4">&quot;BAHTTEXT&quot;</span><span class="s3">, </span><span class="s4">&quot;CHAR&quot;</span><span class="s3">, </span><span class="s4">&quot;CLEAN&quot;</span><span class="s3">, </span><span class="s4">&quot;CODE&quot;</span><span class="s3">, </span><span class="s4">&quot;CONCATENATE&quot;</span><span class="s3">, </span><span class="s4">&quot;DOLLAR&quot;</span><span class="s3">, </span><span class="s4">&quot;EXACT&quot;</span><span class="s3">, </span><span class="s4">&quot;FIND&quot;</span><span class="s3">, </span><span class="s4">&quot;FINDB&quot;</span><span class="s3">, </span><span class="s4">&quot;FIXED&quot;</span><span class="s3">, </span><span class="s4">&quot;JIS&quot;</span><span class="s3">, </span><span class="s4">&quot;LEFT&quot;</span><span class="s3">, </span><span class="s4">&quot;LEFTB&quot;</span><span class="s3">, </span><span class="s4">&quot;LEN&quot;</span><span class="s3">, </span><span class="s4">&quot;LENB&quot;</span><span class="s3">, </span><span class="s4">&quot;LOWER&quot;</span><span class="s3">, </span><span class="s4">&quot;MID&quot;</span><span class="s3">, </span><span class="s4">&quot;MIDB&quot;</span><span class="s3">, </span><span class="s4">&quot;PHONETIC&quot;</span><span class="s3">, </span><span class="s4">&quot;PROPER&quot;</span><span class="s3">, </span><span class="s4">&quot;REPLACE&quot;</span><span class="s3">, </span><span class="s4">&quot;REPLACEB&quot;</span><span class="s3">, </span><span class="s4">&quot;REPT&quot;</span><span class="s3">, </span><span class="s4">&quot;RIGHT&quot;</span><span class="s3">, </span><span class="s4">&quot;RIGHTB&quot;</span><span class="s3">, </span><span class="s4">&quot;SEARCH&quot;</span><span class="s3">, </span><span class="s4">&quot;SEARCHB&quot;</span><span class="s3">, </span><span class="s4">&quot;SUBSTITUTE&quot;</span><span class="s3">, </span><span class="s4">&quot;T&quot;</span><span class="s3">, </span><span class="s4">&quot;TEXT&quot;</span><span class="s3">, </span><span class="s4">&quot;TRIM&quot;</span><span class="s3">, </span><span class="s4">&quot;UPPER&quot;</span><span class="s3">, </span><span class="s4">&quot;VALUE&quot;</span><span class="s3">)</span>

<span class="s1">FORMULAE </span><span class="s3">= </span><span class="s1">frozenset</span><span class="s3">(</span><span class="s1">FORMULAE</span><span class="s3">)</span>


<span class="s5">from </span><span class="s1">openpyxl</span><span class="s3">.</span><span class="s1">formula </span><span class="s5">import </span><span class="s1">Tokenizer</span>


<span class="s5">def </span><span class="s1">validate</span><span class="s3">(</span><span class="s1">formula</span><span class="s3">):</span>
    <span class="s2">&quot;&quot;&quot; 
    Utility function for checking whether a formula is syntactically correct 
    &quot;&quot;&quot;</span>
    <span class="s5">assert </span><span class="s1">formula</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span><span class="s4">&quot;=&quot;</span><span class="s3">)</span>
    <span class="s1">formula </span><span class="s3">= </span><span class="s1">Tokenizer</span><span class="s3">(</span><span class="s1">formula</span><span class="s3">)</span>
    <span class="s5">for </span><span class="s1">t </span><span class="s5">in </span><span class="s1">formula</span><span class="s3">.</span><span class="s1">items</span><span class="s3">:</span>
        <span class="s5">if </span><span class="s1">t</span><span class="s3">.</span><span class="s1">type </span><span class="s3">== </span><span class="s4">&quot;FUNC&quot; </span><span class="s5">and </span><span class="s1">t</span><span class="s3">.</span><span class="s1">subtype </span><span class="s3">== </span><span class="s4">&quot;OPEN&quot;</span><span class="s3">:</span>
            <span class="s5">if not </span><span class="s1">t</span><span class="s3">.</span><span class="s1">value</span><span class="s3">.</span><span class="s1">startswith</span><span class="s3">(</span><span class="s4">&quot;_xlfn.&quot;</span><span class="s3">) </span><span class="s5">and </span><span class="s1">t</span><span class="s3">.</span><span class="s1">value</span><span class="s3">[:-</span><span class="s6">1</span><span class="s3">] </span><span class="s5">not in </span><span class="s1">FORMULAE</span><span class="s3">:</span>
                <span class="s5">raise </span><span class="s1">ValueError</span><span class="s3">(</span><span class="s4">f&quot;Unknown function </span><span class="s5">{</span><span class="s1">t</span><span class="s3">.</span><span class="s1">value</span><span class="s5">} </span><span class="s4">in </span><span class="s5">{</span><span class="s1">formula</span><span class="s3">.</span><span class="s1">formula</span><span class="s5">}</span><span class="s4">. The function may need a prefix&quot;</span><span class="s3">)</span>
</pre>
</body>
</html>