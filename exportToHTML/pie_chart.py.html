<html>
<head>
<title>pie_chart.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
.s6 { color: #5f826b; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
pie_chart.py</font>
</center></td></tr></table>
<pre><span class="s0">#Autogenerated schema</span>
<span class="s2">from </span><span class="s1">openpyxl</span><span class="s3">.</span><span class="s1">descriptors</span><span class="s3">.</span><span class="s1">serialisable </span><span class="s2">import </span><span class="s1">Serialisable</span>
<span class="s2">from </span><span class="s1">openpyxl</span><span class="s3">.</span><span class="s1">descriptors </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">Typed</span><span class="s3">,</span>
    <span class="s1">Bool</span><span class="s3">,</span>
    <span class="s1">MinMax</span><span class="s3">,</span>
    <span class="s1">Integer</span><span class="s3">,</span>
    <span class="s1">NoneSet</span><span class="s3">,</span>
    <span class="s1">Float</span><span class="s3">,</span>
    <span class="s1">Alias</span><span class="s3">,</span>
    <span class="s1">Sequence</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">from </span><span class="s1">openpyxl</span><span class="s3">.</span><span class="s1">descriptors</span><span class="s3">.</span><span class="s1">excel </span><span class="s2">import </span><span class="s1">ExtensionList</span><span class="s3">, </span><span class="s1">Percentage</span>
<span class="s2">from </span><span class="s1">openpyxl</span><span class="s3">.</span><span class="s1">descriptors</span><span class="s3">.</span><span class="s1">nested </span><span class="s2">import </span><span class="s3">(</span>
    <span class="s1">NestedBool</span><span class="s3">,</span>
    <span class="s1">NestedMinMax</span><span class="s3">,</span>
    <span class="s1">NestedInteger</span><span class="s3">,</span>
    <span class="s1">NestedFloat</span><span class="s3">,</span>
    <span class="s1">NestedNoneSet</span><span class="s3">,</span>
    <span class="s1">NestedSet</span><span class="s3">,</span>
<span class="s3">)</span>
<span class="s2">from </span><span class="s1">openpyxl</span><span class="s3">.</span><span class="s1">descriptors</span><span class="s3">.</span><span class="s1">sequence </span><span class="s2">import </span><span class="s1">ValueSequence</span>

<span class="s2">from </span><span class="s3">.</span><span class="s1">_chart </span><span class="s2">import </span><span class="s1">ChartBase</span>
<span class="s2">from </span><span class="s3">.</span><span class="s1">axis </span><span class="s2">import </span><span class="s1">ChartLines</span>
<span class="s2">from </span><span class="s3">.</span><span class="s1">descriptors </span><span class="s2">import </span><span class="s1">NestedGapAmount</span>
<span class="s2">from </span><span class="s3">.</span><span class="s1">series </span><span class="s2">import </span><span class="s1">Series</span>
<span class="s2">from </span><span class="s3">.</span><span class="s1">label </span><span class="s2">import </span><span class="s1">DataLabelList</span>


<span class="s2">class </span><span class="s1">_PieChartBase</span><span class="s3">(</span><span class="s1">ChartBase</span><span class="s3">):</span>

    <span class="s1">varyColors </span><span class="s3">= </span><span class="s1">NestedBool</span><span class="s3">(</span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">ser </span><span class="s3">= </span><span class="s1">Sequence</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">Series</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">dLbls </span><span class="s3">= </span><span class="s1">Typed</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">DataLabelList</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">dataLabels </span><span class="s3">= </span><span class="s1">Alias</span><span class="s3">(</span><span class="s4">&quot;dLbls&quot;</span><span class="s3">)</span>

    <span class="s1">_series_type </span><span class="s3">= </span><span class="s4">&quot;pie&quot;</span>

    <span class="s1">__elements__ </span><span class="s3">= (</span><span class="s4">'varyColors'</span><span class="s3">, </span><span class="s4">'ser'</span><span class="s3">, </span><span class="s4">'dLbls'</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">,</span>
                 <span class="s1">varyColors</span><span class="s3">=</span><span class="s2">True</span><span class="s3">,</span>
                 <span class="s1">ser</span><span class="s3">=(),</span>
                 <span class="s1">dLbls</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                <span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">varyColors </span><span class="s3">= </span><span class="s1">varyColors</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">ser </span><span class="s3">= </span><span class="s1">ser</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">dLbls </span><span class="s3">= </span><span class="s1">dLbls</span>
        <span class="s1">super</span><span class="s3">(</span><span class="s1">_PieChartBase</span><span class="s3">, </span><span class="s1">self</span><span class="s3">).</span><span class="s1">__init__</span><span class="s3">()</span>



<span class="s2">class </span><span class="s1">PieChart</span><span class="s3">(</span><span class="s1">_PieChartBase</span><span class="s3">):</span>

    <span class="s1">tagname </span><span class="s3">= </span><span class="s4">&quot;pieChart&quot;</span>

    <span class="s1">varyColors </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">varyColors</span>
    <span class="s1">ser </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">ser</span>
    <span class="s1">dLbls </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">dLbls</span>

    <span class="s1">firstSliceAng </span><span class="s3">= </span><span class="s1">NestedMinMax</span><span class="s3">(</span><span class="s1">min</span><span class="s3">=</span><span class="s5">0</span><span class="s3">, </span><span class="s1">max</span><span class="s3">=</span><span class="s5">360</span><span class="s3">)</span>
    <span class="s1">extLst </span><span class="s3">= </span><span class="s1">Typed</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">ExtensionList</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s1">__elements__ </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">__elements__ </span><span class="s3">+ (</span><span class="s4">'firstSliceAng'</span><span class="s3">, )</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">,</span>
                 <span class="s1">firstSliceAng</span><span class="s3">=</span><span class="s5">0</span><span class="s3">,</span>
                 <span class="s1">extLst</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                 <span class="s3">**</span><span class="s1">kw</span>
                <span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">firstSliceAng </span><span class="s3">= </span><span class="s1">firstSliceAng</span>
        <span class="s1">super</span><span class="s3">(</span><span class="s1">PieChart</span><span class="s3">, </span><span class="s1">self</span><span class="s3">).</span><span class="s1">__init__</span><span class="s3">(**</span><span class="s1">kw</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">PieChart3D</span><span class="s3">(</span><span class="s1">_PieChartBase</span><span class="s3">):</span>

    <span class="s1">tagname </span><span class="s3">= </span><span class="s4">&quot;pie3DChart&quot;</span>

    <span class="s1">varyColors </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">varyColors</span>
    <span class="s1">ser </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">ser</span>
    <span class="s1">dLbls </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">dLbls</span>

    <span class="s1">extLst </span><span class="s3">= </span><span class="s1">Typed</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">ExtensionList</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s1">__elements__ </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">__elements__</span>


<span class="s2">class </span><span class="s1">DoughnutChart</span><span class="s3">(</span><span class="s1">_PieChartBase</span><span class="s3">):</span>

    <span class="s1">tagname </span><span class="s3">= </span><span class="s4">&quot;doughnutChart&quot;</span>

    <span class="s1">varyColors </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">varyColors</span>
    <span class="s1">ser </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">ser</span>
    <span class="s1">dLbls </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">dLbls</span>

    <span class="s1">firstSliceAng </span><span class="s3">= </span><span class="s1">NestedMinMax</span><span class="s3">(</span><span class="s1">min</span><span class="s3">=</span><span class="s5">0</span><span class="s3">, </span><span class="s1">max</span><span class="s3">=</span><span class="s5">360</span><span class="s3">)</span>
    <span class="s1">holeSize </span><span class="s3">= </span><span class="s1">NestedMinMax</span><span class="s3">(</span><span class="s1">min</span><span class="s3">=</span><span class="s5">1</span><span class="s3">, </span><span class="s1">max</span><span class="s3">=</span><span class="s5">90</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">extLst </span><span class="s3">= </span><span class="s1">Typed</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">ExtensionList</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s1">__elements__ </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">__elements__ </span><span class="s3">+ (</span><span class="s4">'firstSliceAng'</span><span class="s3">, </span><span class="s4">'holeSize'</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">,</span>
                 <span class="s1">firstSliceAng</span><span class="s3">=</span><span class="s5">0</span><span class="s3">,</span>
                 <span class="s1">holeSize</span><span class="s3">=</span><span class="s5">10</span><span class="s3">,</span>
                 <span class="s1">extLst</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                 <span class="s3">**</span><span class="s1">kw</span>
                <span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">firstSliceAng </span><span class="s3">= </span><span class="s1">firstSliceAng</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">holeSize </span><span class="s3">= </span><span class="s1">holeSize</span>
        <span class="s1">super</span><span class="s3">(</span><span class="s1">DoughnutChart</span><span class="s3">, </span><span class="s1">self</span><span class="s3">).</span><span class="s1">__init__</span><span class="s3">(**</span><span class="s1">kw</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">CustomSplit</span><span class="s3">(</span><span class="s1">Serialisable</span><span class="s3">):</span>

    <span class="s1">tagname </span><span class="s3">= </span><span class="s4">&quot;custSplit&quot;</span>

    <span class="s1">secondPiePt </span><span class="s3">= </span><span class="s1">ValueSequence</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">int</span><span class="s3">)</span>

    <span class="s1">__elements__ </span><span class="s3">= (</span><span class="s4">'secondPiePt'</span><span class="s3">,)</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">,</span>
                 <span class="s1">secondPiePt</span><span class="s3">=(),</span>
                <span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">secondPiePt </span><span class="s3">= </span><span class="s1">secondPiePt</span>


<span class="s2">class </span><span class="s1">ProjectedPieChart</span><span class="s3">(</span><span class="s1">_PieChartBase</span><span class="s3">):</span>

    <span class="s6">&quot;&quot;&quot; 
    From the spec 21.2.2.126 
 
    This element contains the pie of pie or bar of pie series on this 
    chart. Only the first series shall be displayed. The splitType element 
    shall determine whether the splitPos and custSplit elements apply. 
    &quot;&quot;&quot;</span>

    <span class="s1">tagname </span><span class="s3">= </span><span class="s4">&quot;ofPieChart&quot;</span>

    <span class="s1">varyColors </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">varyColors</span>
    <span class="s1">ser </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">ser</span>
    <span class="s1">dLbls </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">dLbls</span>

    <span class="s1">ofPieType </span><span class="s3">= </span><span class="s1">NestedSet</span><span class="s3">(</span><span class="s1">values</span><span class="s3">=([</span><span class="s4">'pie'</span><span class="s3">, </span><span class="s4">'bar'</span><span class="s3">]))</span>
    <span class="s1">type </span><span class="s3">= </span><span class="s1">Alias</span><span class="s3">(</span><span class="s4">'ofPieType'</span><span class="s3">)</span>
    <span class="s1">gapWidth </span><span class="s3">= </span><span class="s1">NestedGapAmount</span><span class="s3">()</span>
    <span class="s1">splitType </span><span class="s3">= </span><span class="s1">NestedNoneSet</span><span class="s3">(</span><span class="s1">values</span><span class="s3">=([</span><span class="s4">'auto'</span><span class="s3">, </span><span class="s4">'cust'</span><span class="s3">, </span><span class="s4">'percent'</span><span class="s3">, </span><span class="s4">'pos'</span><span class="s3">, </span><span class="s4">'val'</span><span class="s3">]))</span>
    <span class="s1">splitPos </span><span class="s3">= </span><span class="s1">NestedFloat</span><span class="s3">(</span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">custSplit </span><span class="s3">= </span><span class="s1">Typed</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">CustomSplit</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">secondPieSize </span><span class="s3">= </span><span class="s1">NestedMinMax</span><span class="s3">(</span><span class="s1">min</span><span class="s3">=</span><span class="s5">5</span><span class="s3">, </span><span class="s1">max</span><span class="s3">=</span><span class="s5">200</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">serLines </span><span class="s3">= </span><span class="s1">Typed</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">ChartLines</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>
    <span class="s1">join_lines </span><span class="s3">= </span><span class="s1">Alias</span><span class="s3">(</span><span class="s4">'serLines'</span><span class="s3">)</span>
    <span class="s1">extLst </span><span class="s3">= </span><span class="s1">Typed</span><span class="s3">(</span><span class="s1">expected_type</span><span class="s3">=</span><span class="s1">ExtensionList</span><span class="s3">, </span><span class="s1">allow_none</span><span class="s3">=</span><span class="s2">True</span><span class="s3">)</span>

    <span class="s1">__elements__ </span><span class="s3">= </span><span class="s1">_PieChartBase</span><span class="s3">.</span><span class="s1">__elements__ </span><span class="s3">+ (</span><span class="s4">'ofPieType'</span><span class="s3">, </span><span class="s4">'gapWidth'</span><span class="s3">,</span>
                                                 <span class="s4">'splitType'</span><span class="s3">, </span><span class="s4">'splitPos'</span><span class="s3">, </span><span class="s4">'custSplit'</span><span class="s3">, </span><span class="s4">'secondPieSize'</span><span class="s3">, </span><span class="s4">'serLines'</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">,</span>
                 <span class="s1">ofPieType</span><span class="s3">=</span><span class="s4">&quot;pie&quot;</span><span class="s3">,</span>
                 <span class="s1">gapWidth</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                 <span class="s1">splitType</span><span class="s3">=</span><span class="s4">&quot;auto&quot;</span><span class="s3">,</span>
                 <span class="s1">splitPos</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                 <span class="s1">custSplit</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                 <span class="s1">secondPieSize</span><span class="s3">=</span><span class="s5">75</span><span class="s3">,</span>
                 <span class="s1">serLines</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                 <span class="s1">extLst</span><span class="s3">=</span><span class="s2">None</span><span class="s3">,</span>
                 <span class="s3">**</span><span class="s1">kw</span>
                <span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">ofPieType </span><span class="s3">= </span><span class="s1">ofPieType</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">gapWidth </span><span class="s3">= </span><span class="s1">gapWidth</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">splitType </span><span class="s3">= </span><span class="s1">splitType</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">splitPos </span><span class="s3">= </span><span class="s1">splitPos</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">custSplit </span><span class="s3">= </span><span class="s1">custSplit</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">secondPieSize </span><span class="s3">= </span><span class="s1">secondPieSize</span>
        <span class="s2">if </span><span class="s1">serLines </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">serLines </span><span class="s3">= </span><span class="s1">ChartLines</span><span class="s3">()</span>
        <span class="s1">super</span><span class="s3">(</span><span class="s1">ProjectedPieChart</span><span class="s3">, </span><span class="s1">self</span><span class="s3">).</span><span class="s1">__init__</span><span class="s3">(**</span><span class="s1">kw</span><span class="s3">)</span>
</pre>
</body>
</html>