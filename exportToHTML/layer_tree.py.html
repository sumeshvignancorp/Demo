<html>
<head>
<title>layer_tree.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #5f826b; font-style: italic;}
.s5 { color: #6aab73;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
layer_tree.py</font>
</center></td></tr></table>
<pre><span class="s0"># DO NOT EDIT THIS FILE!</span>
<span class="s0">#</span>
<span class="s0"># This file is generated from the CDP specification. If you need to make</span>
<span class="s0"># changes, edit the generator and regenerate all of the modules.</span>
<span class="s0">#</span>
<span class="s0"># CDP domain: LayerTree (experimental)</span>
<span class="s2">from </span><span class="s1">__future__ </span><span class="s2">import </span><span class="s1">annotations</span>
<span class="s2">from </span><span class="s3">.</span><span class="s1">util </span><span class="s2">import </span><span class="s1">event_class</span><span class="s3">, </span><span class="s1">T_JSON_DICT</span>
<span class="s2">from </span><span class="s1">dataclasses </span><span class="s2">import </span><span class="s1">dataclass</span>
<span class="s2">import </span><span class="s1">enum</span>
<span class="s2">import </span><span class="s1">typing</span>
<span class="s2">from </span><span class="s3">. </span><span class="s2">import </span><span class="s1">dom</span>


<span class="s2">class </span><span class="s1">LayerId</span><span class="s3">(</span><span class="s1">str</span><span class="s3">):</span>
    <span class="s4">''' 
    Unique Layer identifier. 
    '''</span>
    <span class="s2">def </span><span class="s1">to_json</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">self</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">: </span><span class="s1">str</span><span class="s3">) </span><span class="s1">-&gt; LayerId</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span><span class="s1">json</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__repr__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s5">'LayerId({})'</span><span class="s3">.</span><span class="s1">format</span><span class="s3">(</span><span class="s1">super</span><span class="s3">().</span><span class="s1">__repr__</span><span class="s3">())</span>


<span class="s2">class </span><span class="s1">SnapshotId</span><span class="s3">(</span><span class="s1">str</span><span class="s3">):</span>
    <span class="s4">''' 
    Unique snapshot identifier. 
    '''</span>
    <span class="s2">def </span><span class="s1">to_json</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">self</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">: </span><span class="s1">str</span><span class="s3">) </span><span class="s1">-&gt; SnapshotId</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span><span class="s1">json</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__repr__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s5">'SnapshotId({})'</span><span class="s3">.</span><span class="s1">format</span><span class="s3">(</span><span class="s1">super</span><span class="s3">().</span><span class="s1">__repr__</span><span class="s3">())</span>


<span class="s3">@</span><span class="s1">dataclass</span>
<span class="s2">class </span><span class="s1">ScrollRect</span><span class="s3">:</span>
    <span class="s4">''' 
    Rectangle where scrolling happens on the main thread. 
    '''</span>
    <span class="s0">#: Rectangle itself.</span>
    <span class="s1">rect</span><span class="s3">: </span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span>

    <span class="s0">#: Reason for rectangle to force scrolling on the main thread</span>
    <span class="s1">type_</span><span class="s3">: </span><span class="s1">str</span>

    <span class="s2">def </span><span class="s1">to_json</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">json </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'rect'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">rect</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'type'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">type_</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span>
            <span class="s1">rect</span><span class="s3">=</span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'rect'</span><span class="s3">]),</span>
            <span class="s1">type_</span><span class="s3">=</span><span class="s1">str</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'type'</span><span class="s3">]),</span>
        <span class="s3">)</span>


<span class="s3">@</span><span class="s1">dataclass</span>
<span class="s2">class </span><span class="s1">StickyPositionConstraint</span><span class="s3">:</span>
    <span class="s4">''' 
    Sticky position constraints. 
    '''</span>
    <span class="s0">#: Layout rectangle of the sticky element before being shifted</span>
    <span class="s1">sticky_box_rect</span><span class="s3">: </span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span>

    <span class="s0">#: Layout rectangle of the containing block of the sticky element</span>
    <span class="s1">containing_block_rect</span><span class="s3">: </span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span>

    <span class="s0">#: The nearest sticky layer that shifts the sticky box</span>
    <span class="s1">nearest_layer_shifting_sticky_box</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">LayerId</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s0">#: The nearest sticky layer that shifts the containing block</span>
    <span class="s1">nearest_layer_shifting_containing_block</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">LayerId</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">json </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'stickyBoxRect'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">sticky_box_rect</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'containingBlockRect'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">containing_block_rect</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">nearest_layer_shifting_sticky_box </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'nearestLayerShiftingStickyBox'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">nearest_layer_shifting_sticky_box</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">nearest_layer_shifting_containing_block </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'nearestLayerShiftingContainingBlock'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">nearest_layer_shifting_containing_block</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span>
            <span class="s1">sticky_box_rect</span><span class="s3">=</span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'stickyBoxRect'</span><span class="s3">]),</span>
            <span class="s1">containing_block_rect</span><span class="s3">=</span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'containingBlockRect'</span><span class="s3">]),</span>
            <span class="s1">nearest_layer_shifting_sticky_box</span><span class="s3">=</span><span class="s1">LayerId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'nearestLayerShiftingStickyBox'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'nearestLayerShiftingStickyBox' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">nearest_layer_shifting_containing_block</span><span class="s3">=</span><span class="s1">LayerId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'nearestLayerShiftingContainingBlock'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'nearestLayerShiftingContainingBlock' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
        <span class="s3">)</span>


<span class="s3">@</span><span class="s1">dataclass</span>
<span class="s2">class </span><span class="s1">PictureTile</span><span class="s3">:</span>
    <span class="s4">''' 
    Serialized fragment of layer picture along with its offset within the layer. 
    '''</span>
    <span class="s0">#: Offset from owning layer left boundary</span>
    <span class="s1">x</span><span class="s3">: </span><span class="s1">float</span>

    <span class="s0">#: Offset from owning layer top boundary</span>
    <span class="s1">y</span><span class="s3">: </span><span class="s1">float</span>

    <span class="s0">#: Base64-encoded snapshot data.</span>
    <span class="s1">picture</span><span class="s3">: </span><span class="s1">str</span>

    <span class="s2">def </span><span class="s1">to_json</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">json </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'x'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">x</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'y'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">y</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'picture'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">picture</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span>
            <span class="s1">x</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'x'</span><span class="s3">]),</span>
            <span class="s1">y</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'y'</span><span class="s3">]),</span>
            <span class="s1">picture</span><span class="s3">=</span><span class="s1">str</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'picture'</span><span class="s3">]),</span>
        <span class="s3">)</span>


<span class="s3">@</span><span class="s1">dataclass</span>
<span class="s2">class </span><span class="s1">Layer</span><span class="s3">:</span>
    <span class="s4">''' 
    Information about a compositing layer. 
    '''</span>
    <span class="s0">#: The unique id for this layer.</span>
    <span class="s1">layer_id</span><span class="s3">: </span><span class="s1">LayerId</span>

    <span class="s0">#: Offset from parent layer, X coordinate.</span>
    <span class="s1">offset_x</span><span class="s3">: </span><span class="s1">float</span>

    <span class="s0">#: Offset from parent layer, Y coordinate.</span>
    <span class="s1">offset_y</span><span class="s3">: </span><span class="s1">float</span>

    <span class="s0">#: Layer width.</span>
    <span class="s1">width</span><span class="s3">: </span><span class="s1">float</span>

    <span class="s0">#: Layer height.</span>
    <span class="s1">height</span><span class="s3">: </span><span class="s1">float</span>

    <span class="s0">#: Indicates how many time this layer has painted.</span>
    <span class="s1">paint_count</span><span class="s3">: </span><span class="s1">int</span>

    <span class="s0">#: Indicates whether this layer hosts any content, rather than being used for</span>
    <span class="s0">#: transform/scrolling purposes only.</span>
    <span class="s1">draws_content</span><span class="s3">: </span><span class="s1">bool</span>

    <span class="s0">#: The id of parent (not present for root).</span>
    <span class="s1">parent_layer_id</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">LayerId</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s0">#: The backend id for the node associated with this layer.</span>
    <span class="s1">backend_node_id</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">dom</span><span class="s3">.</span><span class="s1">BackendNodeId</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s0">#: Transformation matrix for layer, default is identity matrix</span>
    <span class="s1">transform</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">float</span><span class="s3">]] = </span><span class="s2">None</span>

    <span class="s0">#: Transform anchor point X, absent if no transform specified</span>
    <span class="s1">anchor_x</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">float</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s0">#: Transform anchor point Y, absent if no transform specified</span>
    <span class="s1">anchor_y</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">float</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s0">#: Transform anchor point Z, absent if no transform specified</span>
    <span class="s1">anchor_z</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">float</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s0">#: Set if layer is not visible.</span>
    <span class="s1">invisible</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">bool</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s0">#: Rectangles scrolling on main thread only.</span>
    <span class="s1">scroll_rects</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">ScrollRect</span><span class="s3">]] = </span><span class="s2">None</span>

    <span class="s0">#: Sticky position constraint information</span>
    <span class="s1">sticky_position_constraint</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">StickyPositionConstraint</span><span class="s3">] = </span><span class="s2">None</span>

    <span class="s2">def </span><span class="s1">to_json</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s1">json </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'layerId'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">layer_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'offsetX'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">offset_x</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'offsetY'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">offset_y</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'width'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">width</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'height'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">height</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'paintCount'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">paint_count</span>
        <span class="s1">json</span><span class="s3">[</span><span class="s5">'drawsContent'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">draws_content</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">parent_layer_id </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'parentLayerId'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">parent_layer_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">backend_node_id </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'backendNodeId'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">backend_node_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">transform </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'transform'</span><span class="s3">] = [</span><span class="s1">i </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">transform</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">anchor_x </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'anchorX'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">anchor_x</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">anchor_y </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'anchorY'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">anchor_y</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">anchor_z </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'anchorZ'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">anchor_z</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">invisible </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'invisible'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">invisible</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">scroll_rects </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'scrollRects'</span><span class="s3">] = [</span><span class="s1">i</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">() </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">scroll_rects</span><span class="s3">]</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">sticky_position_constraint </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">json</span><span class="s3">[</span><span class="s5">'stickyPositionConstraint'</span><span class="s3">] = </span><span class="s1">self</span><span class="s3">.</span><span class="s1">sticky_position_constraint</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
        <span class="s2">return </span><span class="s1">json</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span>
            <span class="s1">layer_id</span><span class="s3">=</span><span class="s1">LayerId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'layerId'</span><span class="s3">]),</span>
            <span class="s1">offset_x</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'offsetX'</span><span class="s3">]),</span>
            <span class="s1">offset_y</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'offsetY'</span><span class="s3">]),</span>
            <span class="s1">width</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'width'</span><span class="s3">]),</span>
            <span class="s1">height</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'height'</span><span class="s3">]),</span>
            <span class="s1">paint_count</span><span class="s3">=</span><span class="s1">int</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'paintCount'</span><span class="s3">]),</span>
            <span class="s1">draws_content</span><span class="s3">=</span><span class="s1">bool</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'drawsContent'</span><span class="s3">]),</span>
            <span class="s1">parent_layer_id</span><span class="s3">=</span><span class="s1">LayerId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'parentLayerId'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'parentLayerId' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">backend_node_id</span><span class="s3">=</span><span class="s1">dom</span><span class="s3">.</span><span class="s1">BackendNodeId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'backendNodeId'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'backendNodeId' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">transform</span><span class="s3">=[</span><span class="s1">float</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json</span><span class="s3">[</span><span class="s5">'transform'</span><span class="s3">]] </span><span class="s2">if </span><span class="s5">'transform' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">anchor_x</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'anchorX'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'anchorX' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">anchor_y</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'anchorY'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'anchorY' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">anchor_z</span><span class="s3">=</span><span class="s1">float</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'anchorZ'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'anchorZ' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">invisible</span><span class="s3">=</span><span class="s1">bool</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'invisible'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'invisible' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">scroll_rects</span><span class="s3">=[</span><span class="s1">ScrollRect</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json</span><span class="s3">[</span><span class="s5">'scrollRects'</span><span class="s3">]] </span><span class="s2">if </span><span class="s5">'scrollRects' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
            <span class="s1">sticky_position_constraint</span><span class="s3">=</span><span class="s1">StickyPositionConstraint</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'stickyPositionConstraint'</span><span class="s3">]) </span><span class="s2">if </span><span class="s5">'stickyPositionConstraint' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span><span class="s3">,</span>
        <span class="s3">)</span>


<span class="s2">class </span><span class="s1">PaintProfile</span><span class="s3">(</span><span class="s1">list</span><span class="s3">):</span>
    <span class="s4">''' 
    Array of timings, one per paint step. 
    '''</span>
    <span class="s2">def </span><span class="s1">to_json</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">float</span><span class="s3">]:</span>
        <span class="s2">return </span><span class="s1">self</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">float</span><span class="s3">]) </span><span class="s1">-&gt; PaintProfile</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span><span class="s1">json</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__repr__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s5">'PaintProfile({})'</span><span class="s3">.</span><span class="s1">format</span><span class="s3">(</span><span class="s1">super</span><span class="s3">().</span><span class="s1">__repr__</span><span class="s3">())</span>


<span class="s2">def </span><span class="s1">compositing_reasons</span><span class="s3">(</span>
        <span class="s1">layer_id</span><span class="s3">: </span><span class="s1">LayerId</span>
    <span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Tuple</span><span class="s3">[</span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">str</span><span class="s3">], </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">str</span><span class="s3">]]]:</span>
    <span class="s4">''' 
    Provides the reasons why the given layer was composited. 
 
    :param layer_id: The id of the layer for which we want to get the reasons it was composited. 
    :returns: A tuple with the following items: 
 
        0. **compositingReasons** - A list of strings specifying reasons for the given layer to become composited. 
        1. **compositingReasonIds** - A list of strings specifying reason IDs for the given layer to become composited. 
    '''</span>
    <span class="s1">params</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
    <span class="s1">params</span><span class="s3">[</span><span class="s5">'layerId'</span><span class="s3">] = </span><span class="s1">layer_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.compositingReasons'</span><span class="s3">,</span>
        <span class="s5">'params'</span><span class="s3">: </span><span class="s1">params</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>
    <span class="s2">return </span><span class="s3">(</span>
        <span class="s3">[</span><span class="s1">str</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json</span><span class="s3">[</span><span class="s5">'compositingReasons'</span><span class="s3">]],</span>
        <span class="s3">[</span><span class="s1">str</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json</span><span class="s3">[</span><span class="s5">'compositingReasonIds'</span><span class="s3">]]</span>
    <span class="s3">)</span>


<span class="s2">def </span><span class="s1">disable</span><span class="s3">() </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s2">None</span><span class="s3">]:</span>
    <span class="s4">''' 
    Disables compositing tree inspection. 
    '''</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.disable'</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>


<span class="s2">def </span><span class="s1">enable</span><span class="s3">() </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s2">None</span><span class="s3">]:</span>
    <span class="s4">''' 
    Enables compositing tree inspection. 
    '''</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.enable'</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>


<span class="s2">def </span><span class="s1">load_snapshot</span><span class="s3">(</span>
        <span class="s1">tiles</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">PictureTile</span><span class="s3">]</span>
    <span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">SnapshotId</span><span class="s3">]:</span>
    <span class="s4">''' 
    Returns the snapshot identifier. 
 
    :param tiles: An array of tiles composing the snapshot. 
    :returns: The id of the snapshot. 
    '''</span>
    <span class="s1">params</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
    <span class="s1">params</span><span class="s3">[</span><span class="s5">'tiles'</span><span class="s3">] = [</span><span class="s1">i</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">() </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">tiles</span><span class="s3">]</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.loadSnapshot'</span><span class="s3">,</span>
        <span class="s5">'params'</span><span class="s3">: </span><span class="s1">params</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>
    <span class="s2">return </span><span class="s1">SnapshotId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'snapshotId'</span><span class="s3">])</span>


<span class="s2">def </span><span class="s1">make_snapshot</span><span class="s3">(</span>
        <span class="s1">layer_id</span><span class="s3">: </span><span class="s1">LayerId</span>
    <span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">SnapshotId</span><span class="s3">]:</span>
    <span class="s4">''' 
    Returns the layer snapshot identifier. 
 
    :param layer_id: The id of the layer. 
    :returns: The id of the layer snapshot. 
    '''</span>
    <span class="s1">params</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
    <span class="s1">params</span><span class="s3">[</span><span class="s5">'layerId'</span><span class="s3">] = </span><span class="s1">layer_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.makeSnapshot'</span><span class="s3">,</span>
        <span class="s5">'params'</span><span class="s3">: </span><span class="s1">params</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>
    <span class="s2">return </span><span class="s1">SnapshotId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'snapshotId'</span><span class="s3">])</span>


<span class="s2">def </span><span class="s1">profile_snapshot</span><span class="s3">(</span>
        <span class="s1">snapshot_id</span><span class="s3">: </span><span class="s1">SnapshotId</span><span class="s3">,</span>
        <span class="s1">min_repeat_count</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">int</span><span class="s3">] = </span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">min_duration</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">float</span><span class="s3">] = </span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">clip_rect</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span><span class="s3">] = </span><span class="s2">None</span>
    <span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">PaintProfile</span><span class="s3">]]:</span>
    <span class="s4">''' 
    :param snapshot_id: The id of the layer snapshot. 
    :param min_repeat_count: *(Optional)* The maximum number of times to replay the snapshot (1, if not specified). 
    :param min_duration: *(Optional)* The minimum duration (in seconds) to replay the snapshot. 
    :param clip_rect: *(Optional)* The clip rectangle to apply when replaying the snapshot. 
    :returns: The array of paint profiles, one per run. 
    '''</span>
    <span class="s1">params</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
    <span class="s1">params</span><span class="s3">[</span><span class="s5">'snapshotId'</span><span class="s3">] = </span><span class="s1">snapshot_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
    <span class="s2">if </span><span class="s1">min_repeat_count </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">params</span><span class="s3">[</span><span class="s5">'minRepeatCount'</span><span class="s3">] = </span><span class="s1">min_repeat_count</span>
    <span class="s2">if </span><span class="s1">min_duration </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">params</span><span class="s3">[</span><span class="s5">'minDuration'</span><span class="s3">] = </span><span class="s1">min_duration</span>
    <span class="s2">if </span><span class="s1">clip_rect </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">params</span><span class="s3">[</span><span class="s5">'clipRect'</span><span class="s3">] = </span><span class="s1">clip_rect</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.profileSnapshot'</span><span class="s3">,</span>
        <span class="s5">'params'</span><span class="s3">: </span><span class="s1">params</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>
    <span class="s2">return </span><span class="s3">[</span><span class="s1">PaintProfile</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json</span><span class="s3">[</span><span class="s5">'timings'</span><span class="s3">]]</span>


<span class="s2">def </span><span class="s1">release_snapshot</span><span class="s3">(</span>
        <span class="s1">snapshot_id</span><span class="s3">: </span><span class="s1">SnapshotId</span>
    <span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s2">None</span><span class="s3">]:</span>
    <span class="s4">''' 
    Releases layer snapshot captured by the back-end. 
 
    :param snapshot_id: The id of the layer snapshot. 
    '''</span>
    <span class="s1">params</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
    <span class="s1">params</span><span class="s3">[</span><span class="s5">'snapshotId'</span><span class="s3">] = </span><span class="s1">snapshot_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.releaseSnapshot'</span><span class="s3">,</span>
        <span class="s5">'params'</span><span class="s3">: </span><span class="s1">params</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>


<span class="s2">def </span><span class="s1">replay_snapshot</span><span class="s3">(</span>
        <span class="s1">snapshot_id</span><span class="s3">: </span><span class="s1">SnapshotId</span><span class="s3">,</span>
        <span class="s1">from_step</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">int</span><span class="s3">] = </span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">to_step</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">int</span><span class="s3">] = </span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">scale</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">float</span><span class="s3">] = </span><span class="s2">None</span>
    <span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">str</span><span class="s3">]:</span>
    <span class="s4">''' 
    Replays the layer snapshot and returns the resulting bitmap. 
 
    :param snapshot_id: The id of the layer snapshot. 
    :param from_step: *(Optional)* The first step to replay from (replay from the very start if not specified). 
    :param to_step: *(Optional)* The last step to replay to (replay till the end if not specified). 
    :param scale: *(Optional)* The scale to apply while replaying (defaults to 1). 
    :returns: A data: URL for resulting image. 
    '''</span>
    <span class="s1">params</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
    <span class="s1">params</span><span class="s3">[</span><span class="s5">'snapshotId'</span><span class="s3">] = </span><span class="s1">snapshot_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
    <span class="s2">if </span><span class="s1">from_step </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">params</span><span class="s3">[</span><span class="s5">'fromStep'</span><span class="s3">] = </span><span class="s1">from_step</span>
    <span class="s2">if </span><span class="s1">to_step </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">params</span><span class="s3">[</span><span class="s5">'toStep'</span><span class="s3">] = </span><span class="s1">to_step</span>
    <span class="s2">if </span><span class="s1">scale </span><span class="s2">is not None</span><span class="s3">:</span>
        <span class="s1">params</span><span class="s3">[</span><span class="s5">'scale'</span><span class="s3">] = </span><span class="s1">scale</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.replaySnapshot'</span><span class="s3">,</span>
        <span class="s5">'params'</span><span class="s3">: </span><span class="s1">params</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>
    <span class="s2">return </span><span class="s1">str</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'dataURL'</span><span class="s3">])</span>


<span class="s2">def </span><span class="s1">snapshot_command_log</span><span class="s3">(</span>
        <span class="s1">snapshot_id</span><span class="s3">: </span><span class="s1">SnapshotId</span>
    <span class="s3">) </span><span class="s1">-&gt; typing</span><span class="s3">.</span><span class="s1">Generator</span><span class="s3">[</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">T_JSON_DICT</span><span class="s3">,</span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">dict</span><span class="s3">]]:</span>
    <span class="s4">''' 
    Replays the layer snapshot and returns canvas log. 
 
    :param snapshot_id: The id of the layer snapshot. 
    :returns: The array of canvas function calls. 
    '''</span>
    <span class="s1">params</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= </span><span class="s1">dict</span><span class="s3">()</span>
    <span class="s1">params</span><span class="s3">[</span><span class="s5">'snapshotId'</span><span class="s3">] = </span><span class="s1">snapshot_id</span><span class="s3">.</span><span class="s1">to_json</span><span class="s3">()</span>
    <span class="s1">cmd_dict</span><span class="s3">: </span><span class="s1">T_JSON_DICT </span><span class="s3">= {</span>
        <span class="s5">'method'</span><span class="s3">: </span><span class="s5">'LayerTree.snapshotCommandLog'</span><span class="s3">,</span>
        <span class="s5">'params'</span><span class="s3">: </span><span class="s1">params</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">json </span><span class="s3">= </span><span class="s2">yield </span><span class="s1">cmd_dict</span>
    <span class="s2">return </span><span class="s3">[</span><span class="s1">dict</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json</span><span class="s3">[</span><span class="s5">'commandLog'</span><span class="s3">]]</span>


<span class="s3">@</span><span class="s1">event_class</span><span class="s3">(</span><span class="s5">'LayerTree.layerPainted'</span><span class="s3">)</span>
<span class="s3">@</span><span class="s1">dataclass</span>
<span class="s2">class </span><span class="s1">LayerPainted</span><span class="s3">:</span>
    <span class="s0">#: The id of the painted layer.</span>
    <span class="s1">layer_id</span><span class="s3">: </span><span class="s1">LayerId</span>
    <span class="s0">#: Clip rectangle.</span>
    <span class="s1">clip</span><span class="s3">: </span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">: </span><span class="s1">T_JSON_DICT</span><span class="s3">) </span><span class="s1">-&gt; LayerPainted</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span>
            <span class="s1">layer_id</span><span class="s3">=</span><span class="s1">LayerId</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'layerId'</span><span class="s3">]),</span>
            <span class="s1">clip</span><span class="s3">=</span><span class="s1">dom</span><span class="s3">.</span><span class="s1">Rect</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">json</span><span class="s3">[</span><span class="s5">'clip'</span><span class="s3">])</span>
        <span class="s3">)</span>


<span class="s3">@</span><span class="s1">event_class</span><span class="s3">(</span><span class="s5">'LayerTree.layerTreeDidChange'</span><span class="s3">)</span>
<span class="s3">@</span><span class="s1">dataclass</span>
<span class="s2">class </span><span class="s1">LayerTreeDidChange</span><span class="s3">:</span>
    <span class="s0">#: Layer tree, absent if not in the comspositing mode.</span>
    <span class="s1">layers</span><span class="s3">: </span><span class="s1">typing</span><span class="s3">.</span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">typing</span><span class="s3">.</span><span class="s1">List</span><span class="s3">[</span><span class="s1">Layer</span><span class="s3">]]</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">json</span><span class="s3">: </span><span class="s1">T_JSON_DICT</span><span class="s3">) </span><span class="s1">-&gt; LayerTreeDidChange</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span>
            <span class="s1">layers</span><span class="s3">=[</span><span class="s1">Layer</span><span class="s3">.</span><span class="s1">from_json</span><span class="s3">(</span><span class="s1">i</span><span class="s3">) </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">json</span><span class="s3">[</span><span class="s5">'layers'</span><span class="s3">]] </span><span class="s2">if </span><span class="s5">'layers' </span><span class="s2">in </span><span class="s1">json </span><span class="s2">else None</span>
        <span class="s3">)</span>
</pre>
</body>
</html>